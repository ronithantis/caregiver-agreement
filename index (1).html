<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>╫к╫Щ╫Р╫Х╫Э ╫ж╫Щ╫д╫Щ╫Х╫к тАФ ╫в╫Х╫С╫У/╫к ╫б╫Щ╫в╫Х╫У</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <style>body{margin:0;background:#fff}</style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel" data-presets="react">
const { useState, useContext, createContext } = React;

const FormCtx = createContext(null);

/* тФАтФАтФА GLOBAL STYLES тФАтФАтФА */
const STYLE = `
  @import url('https://fonts.googleapis.com/css2?family=Heebo:wght@300;400;500;600;700&display=swap');
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { font-family: 'Heebo', sans-serif; background: #fff; color: #111; direction: rtl; font-size: 16px; }

  /* тФАтФА FORM тФАтФА */
  .wrap { max-width: 800px; margin: 0 auto; padding: 48px 28px 100px; }
  .main-title { font-size: 34px; font-weight: 700; letter-spacing: -0.5px; line-height: 1.1; }
  .main-sub { font-size: 15px; font-weight: 300; color: #777; margin-top: 4px; padding-bottom: 20px; border-bottom: 1.5px solid #111; margin-bottom: 52px; }
  
  .sec { margin-bottom: 56px; }
  .sec-title {
    font-size: 11px; font-weight: 700; letter-spacing: 2.5px; text-transform: uppercase;
    color: #111; padding-bottom: 10px; border-bottom: 1px solid #ddd; margin-bottom: 28px;
  }
  .sec-num { color: #bbb; margin-left: 6px; }
  
  .fg { margin-bottom: 22px; }
  .fg label { display: block; font-size: 14px; font-weight: 600; margin-bottom: 7px; color: #444; }
  .fg .hint { font-size: 12px; color: #aaa; margin-bottom: 6px; font-weight: 400; }
  
  input[type="text"], input[type="date"], select {
    width: 100%; border: none; border-bottom: 1px solid #ccc;
    padding: 9px 0; font-family: 'Heebo', sans-serif; font-size: 15px;
    background: transparent; outline: none; color: #111; direction: rtl;
    transition: border-color 0.15s;
  }
  input:focus, select:focus { border-bottom-color: #111; }
  select { cursor: pointer; }
  textarea {
    width: 100%; border: 1px solid #ccc; padding: 12px; font-family: 'Heebo', sans-serif;
    font-size: 15px; background: #fafafa; outline: none; color: #111; direction: rtl;
    resize: vertical; min-height: 80px; transition: border-color 0.15s; border-radius: 1px;
  }
  textarea:focus { border-color: #111; background: #fff; }
  
  .grid2 { display: grid; grid-template-columns: 1fr 1fr; gap: 28px; }
  .grid3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; }
  
  .radios { display: flex; gap: 28px; flex-wrap: wrap; margin-top: 6px; }
  .radios label { display: flex; align-items: center; gap: 7px; font-size: 14px; font-weight: 400; color: #333; cursor: pointer; margin-bottom: 0; }
  input[type="radio"], input[type="checkbox"] { width: 16px; height: 16px; cursor: pointer; accent-color: #111; }
  
  .task-table { width: 100%; border-collapse: collapse; }
  .task-table th { font-size: 12px; font-weight: 600; text-align: right; padding: 9px 14px; background: #f5f5f5; border-bottom: 1px solid #ddd; color: #333; }
  .task-table td { padding: 8px 14px; border-bottom: 1px solid #f0f0f0; font-size: 14px; vertical-align: middle; }
  .task-table td:first-child { font-weight: 500; width: 30%; }
  .task-table td input[type="text"] { font-size: 14px; padding: 5px 0; }
  .task-table td select { font-size: 14px; padding: 5px 0; }
  
  .alert {
    border: 1.5px solid #111; padding: 18px 22px; margin: 12px 0 20px;
    background: #fff;
  }
  .alert p { font-size: 13px; line-height: 1.8; margin-bottom: 10px; }
  .alert p:last-child { margin-bottom: 0; }
  .alert strong { font-weight: 700; }
  
  .ack-row { display: flex; align-items: flex-start; gap: 10px; padding: 12px 0; border-top: 1px solid #eee; }
  .ack-row input { margin-top: 3px; flex-shrink: 0; }
  .ack-row span { font-size: 13px; line-height: 1.6; }
  
  .btn { 
    background: #111; color: #fff; border: none; padding: 15px 44px;
    font-family: 'Heebo', sans-serif; font-size: 15px; font-weight: 600;
    cursor: pointer; letter-spacing: 0.3px; display: inline-block;
    transition: background 0.15s;
  }
  .btn:hover { background: #333; }
  .btn:disabled { background: #ccc; cursor: not-allowed; }
  .btn-out { background: #fff; color: #111; border: 1.5px solid #111; padding: 13px 36px; font-family: 'Heebo', sans-serif; font-size: 14px; font-weight: 500; cursor: pointer; margin-right: 12px; }
  .btn-out:hover { background: #f5f5f5; }
  
  .lang-select-wrap { display: flex; align-items: center; gap: 16px; margin-bottom: 48px; padding: 20px 24px; background: #f8f8f8; }
  .lang-select-wrap label { font-size: 13px; font-weight: 600; margin-bottom: 0; }
  .lang-select-wrap select { border: 1px solid #ccc; padding: 8px 12px; width: auto; flex: 1; }
  
  .loading { text-align: center; padding: 80px 0; font-size: 14px; color: #666; }
  .loading::after { content: ''; display: block; width: 30px; height: 30px; border: 2px solid #ddd; border-top-color: #111; border-radius: 50%; animation: spin 0.7s linear infinite; margin: 20px auto 0; }
  @keyframes spin { to { transform: rotate(360deg); } }
  
  /* тФАтФА REPORT тФАтФА */
  .rpt { max-width: 800px; margin: 0 auto; padding: 40px 28px; direction: rtl; }
  .rpt-hdr { text-align: center; padding-bottom: 20px; margin-bottom: 36px; border-bottom: 2px solid #111; }
  .rpt-hdr-title { font-size: 24px; font-weight: 700; }
  .rpt-hdr-sub { font-size: 14px; color: #777; margin-top: 5px; }
  .rpt-meta { display: flex; justify-content: space-between; font-size: 13px; color: #555; margin-top: 10px; }
  
  .rpt-sec { margin-bottom: 36px; page-break-inside: avoid; }
  .rpt-sec-title { font-size: 10px; font-weight: 700; letter-spacing: 2.5px; text-transform: uppercase; padding-bottom: 8px; border-bottom: 1px solid #bbb; margin-bottom: 18px; color: #333; }
  
  .bi-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 14px; padding-bottom: 14px; border-bottom: 1px solid #f0f0f0; page-break-inside: avoid; }
  .bi-he { direction: rtl; }
  .bi-tr { direction: ltr; text-align: left; }
  .bi-lbl { font-size: 11px; color: #999; margin-bottom: 3px; }
  .bi-val { font-size: 14px; line-height: 1.5; }
  .bi-val.empty { color: #bbb; font-style: italic; font-size: 12px; }
  
  .rpt-clause { border: 1px solid #111; padding: 16px 20px; margin: 12px 0; page-break-inside: avoid; }
  .rpt-clause p { font-size: 12px; line-height: 1.7; }
  
  .sig-wrap { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-top: 32px; page-break-inside: avoid; }
  .sig-box { border: 1px solid #ccc; padding: 22px 18px; }
  .sig-box-title { font-size: 11px; font-weight: 700; margin-bottom: 32px; }
  .sig-line { border-bottom: 1px solid #888; margin-top: 40px; }
  .sig-label { font-size: 10px; color: #888; margin-top: 4px; }
  
  .col-hdr { font-size: 10px; font-weight: 700; color: #999; border-bottom: 1px solid #ddd; padding-bottom: 6px; margin-bottom: 12px; }
  .col-hdr.ltr { direction: ltr; text-align: left; }
  
  @media print {
    .no-print { display: none !important; }
    .print-hide { display: none !important; }
    html, body { direction: rtl; background: #fff; }
    .rpt { padding: 0; max-width: 100%; display: block !important; }
    @page { size: A4 portrait; margin: 15mm 18mm; }
    .rpt-sec { page-break-inside: avoid; }
    .bi-row { page-break-inside: avoid; }
    .sig-wrap { page-break-inside: avoid; }
  }
`;

const TASKS = [
  { key: "bathing",      he: "╫и╫Ч╫ж╫Ф / ╫з╫а╫Х╫Ч" },
  { key: "diaper",       he: "╫Ф╫Ч╫Ь╫д╫к ╫Ч╫Щ╫к╫Х╫Ь / ╫Ю╫Х╫ж╫и╫Щ ╫б╫д╫Щ╫Т╫Ф" },
  { key: "medication",   he: "╫Ю╫к╫Я ╫к╫и╫Х╫д╫Х╫к" },
  { key: "mobility",     he: "╫а╫Щ╫Х╫У / ╫й╫Щ╫Ю╫Х╫й ╫С╫Ю╫а╫Х╫г" },
  { key: "doctor",       he: "╫Ь╫Щ╫Х╫Х╫Щ ╫Ь╫и╫Х╫д╫Р / ╫С╫У╫Щ╫з╫Х╫к" },
  { key: "physio",       he: "╫д╫Щ╫Ц╫Щ╫Х╫к╫и╫д╫Щ╫Ф ╫С╫Щ╫к╫Щ╫к" },
  { key: "pressure",     he: "╫Ю╫а╫Щ╫в╫к ╫д╫ж╫в╫Щ ╫Ь╫Ч╫е" },
  { key: "feeding",      he: "╫Ф╫Р╫Ы╫Ь╫Ф" },
];

const MEALS = [
  { key: "breakfast", he: "╫Р╫и╫Х╫Ч╫к ╫С╫Х╫з╫и" },
  { key: "lunch",     he: "╫Р╫и╫Х╫Ч╫к ╫ж╫Ф╫и╫Щ╫Щ╫Э" },
  { key: "dinner",    he: "╫Р╫и╫Х╫Ч╫к ╫в╫и╫С" },
  { key: "snack",     he: "╫Р╫и╫Х╫Ч╫к ╫Ь╫Щ╫Ь╫Ф / ╫а╫й╫а╫Х╫й" },
];

const LANGS = { en: "English", uz: "O╩╗zbekcha (Uzbek)", hi: "рд╣рд┐рдиреНрджреА (Hindi)" };

const EMPTY_FORM = {
  // 0
  patientName: "", patientAge: "", workerName: "", workerOrigin: "", agency: "", startDate: "",
  // 1
  patientStory: "", patientImportant: "", patientMood: "",
  workerBackground: "", workerExpectations: "",
  // 2
  tasks: TASKS.reduce((acc, t) => ({ ...acc, [t.key]: { included: "", notes: "" } }), {}),
  notExpected: "",
  // 3
  meals: MEALS.reduce((acc, m) => ({ ...acc, [m.key]: "" }), {}),
  whoCooks: "", workerCooksForSelf: "", forbiddenFood: "",
  whoShops: "", shoppingPayment: "", workerShopsAlone: "", patientDuringShop: "", receiptRequired: "",
  // 3b
  nightWatch: "", minSleepHours: "", sleepFrom: "", sleepTo: "",
  nightReplacement: "", nightCallMethod: "", nightCompensation: "", nightCompDetails: "",
  // 4
  phonePolicy: "", phoneForbiddenWhen: "",
  smoking: "", smokingArea: "",
  guests: "",
  kosher: "", kosherDetails: "",
  abandonmentAck: false,
  // 5
  salary: "", payDay: "", pocketMoney: "", pocketMoneyType: "", restDay: "",
  leaveNotice: "", leaveChannel: "", sickNotice: "", dailyRest: "",
  terminationAck: false, holidaysSelected: "", holidaysAck: false,
  // 6
  fallProtocol: "", refusalProtocol: "", contactOrder: "",
  distressButton: "", distressDetails: "", ambulanceAuto: "",
  // 7
  openNotes: "",
  // 8
  familySignName: "", workerSignName: "", signDate: "",
};

/* тФАтФАтФА HELPERS тФАтФАтФА */
const val = (v) => v || <span style={{ color: "#bbb", fontStyle: "italic", fontSize: 12 }}>тАФ</span>;
const yesNo = (v) => v === "yes" ? "╫Ы╫Я" : v === "no" ? "╫Ь╫Р" : v || "тАФ";

/* тФАтФАтФА FIELD + R тАФ defined OUTSIDE main component so React never remounts them тФАтФАтФА */
function R({ field, label, hint, type = "text", options }) {
  const { form, upd } = useContext(FormCtx);
  const value = form[field] ?? "";
  return (
    <div className="fg">
      {label && <label>{label}</label>}
      {hint && <div className="hint">{hint}</div>}
      {type === "textarea" ? (
        <textarea value={value} onChange={e => upd(field, e.target.value)} rows={3} />
      ) : type === "radio" ? (
        <div className="radios">
          {options.map(o => (
            <label key={o.v}>
              <input type="radio" name={field} checked={value === o.v} onChange={() => upd(field, o.v)} />
              {o.l}
            </label>
          ))}
        </div>
      ) : (
        <input type={type} value={value} onChange={e => upd(field, e.target.value)} />
      )}
    </div>
  );
}

/* тФАтФАтФА MAIN COMPONENT тФАтФАтФА */
export default function CaregiverAgreement() {
  const [form, setForm] = useState(EMPTY_FORM);
  const [baseLang, setBaseLang] = useState("he");    // "he" | "en"
  const [extraLang, setExtraLang] = useState("none"); // "none" | "en" | "uz" | "hi"
  const [view, setView] = useState("form");
  const [report, setReport] = useState(null);

  const upd = (field, value) => setForm(f => ({ ...f, [field]: value }));
  const updTask = (key, sub, value) => setForm(f => ({ ...f, tasks: { ...f.tasks, [key]: { ...f.tasks[key], [sub]: value } } }));
  const updMeal = (key, value) => setForm(f => ({ ...f, meals: { ...f.meals, [key]: value } }));

  /* translate payload to one language via API */
  const translateTo = async (payload, langKey) => {
    const langName = LANGS[langKey];
    const response = await fetch("https://api.anthropic.com/v1/messages", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model: "claude-sonnet-4-20250514",
        max_tokens: 4000,
        messages: [{
          role: "user",
          content: `You are a professional translator. Translate all Hebrew text values in the following JSON object into ${langName}.
Rules:
- Translate ONLY the "value", "label", "title", and "name" string fields
- Keep the exact JSON structure
- Do not translate keys
- If a value is "тАФ" or empty, keep it as is
- Keep numbers, dates, times as is
- Return ONLY the JSON, no preamble, no markdown code blocks
- For yes/no values in Hebrew (╫Ы╫Я/╫Ь╫Р), translate to ${langName} equivalents

JSON:
${JSON.stringify(payload, null, 2)}`
        }]
      })
    });
    const data = await response.json();
    const raw = data.content.map(c => c.text || "").join("");
    const clean = raw.replace(/^```json\s*/i, "").replace(/```\s*$/i, "").trim();
    return JSON.parse(clean);
  };

  const buildTranslationPayload = () => {
    const d = form;
    return {
      title: "╫к╫Щ╫Р╫Х╫Э ╫ж╫Щ╫д╫Щ╫Х╫к тАФ ╫а╫б╫д╫Ч ╫Ь╫Ч╫Х╫Ц╫Ф",
      subtitle: "╫Ф╫б╫Ы╫Э ╫к╫Щ╫Р╫Х╫Э ╫ж╫Щ╫д╫Щ╫Х╫к ╫С╫Щ╫Я ╫Ю╫й╫д╫Ч╫Ф ╫Ь╫в╫Х╫С╫У/╫к ╫б╫Щ╫в╫Х╫У",
      sections: {
        s0: {
          title: "╫д╫и╫Ш╫Щ╫Э ╫Ы╫Ь╫Ь╫Щ╫Щ╫Э",
          fields: {
            patientName: { label: "╫й╫Э ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к", value: d.patientName },
            patientAge: { label: "╫Т╫Щ╫Ь", value: d.patientAge },
            workerName: { label: "╫й╫Э ╫Ф╫в╫Х╫С╫У/╫к", value: d.workerName },
            workerOrigin: { label: "╫Р╫и╫е ╫Ю╫Х╫ж╫Р", value: d.workerOrigin },
            agency: { label: "╫б╫Х╫Ы╫а╫Х╫к / ╫Ю╫Ю╫ж╫в", value: d.agency },
            startDate: { label: "╫к╫Р╫и╫Щ╫Ъ ╫к╫Ч╫Щ╫Ь╫к ╫в╫С╫Х╫У╫Ф", value: d.startDate },
          }
        },
        s1: {
          title: "╫Ф╫Щ╫Ы╫и╫Х╫к ╫Ф╫У╫У╫Щ╫к",
          fields: {
            patientStory: { label: "╫Ю╫Щ ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к тАФ ╫б╫Щ╫д╫Х╫и ╫Р╫Щ╫й╫Щ", value: d.patientStory },
            patientImportant: { label: "╫Ю╫Ф ╫Ч╫й╫Х╫С ╫Ь╫Х/╫Ь╫Ф ╫С╫Щ╫Х╫Ю╫Щ╫Х╫Э", value: d.patientImportant },
            patientMood: { label: "╫Ю╫Ф ╫Ю╫й╫Ю╫Ч / ╫Ю╫и╫Т╫Щ╫Ц ╫Р╫Х╫к╫Х/╫Р╫Х╫к╫Ф", value: d.patientMood },
            workerBackground: { label: "╫и╫з╫в ╫Р╫Щ╫й╫Щ ╫й╫Ь ╫Ф╫в╫Х╫С╫У/╫к", value: d.workerBackground },
            workerExpectations: { label: "╫ж╫Щ╫д╫Щ╫Х╫к ╫Ф╫в╫Х╫С╫У/╫к ╫Ю╫Ф╫Ю╫й╫и╫Ф", value: d.workerExpectations },
          }
        },
        s2: {
          title: "╫Ю╫ж╫С ╫и╫д╫Х╫Р╫Щ ╫Х╫к╫д╫з╫Щ╫У╫Щ ╫Ш╫Щ╫д╫Х╫Ь",
          tasks: TASKS.map(t => ({
            name: t.he,
            included: d.tasks[t.key]?.included || "тАФ",
            notes: d.tasks[t.key]?.notes || "",
          })),
          notExpected: { label: "╫Ю╫Ф ╫Ь╫Р ╫Ю╫ж╫Х╫д╫Ф ╫Ю╫Ф╫в╫Х╫С╫У/╫к", value: d.notExpected },
        },
        s3: {
          title: "╫б╫У╫и ╫Щ╫Х╫Э тАФ ╫Р╫и╫Х╫Ч╫Х╫к, ╫С╫Щ╫й╫Х╫Ь ╫Х╫з╫а╫Щ╫Х╫к",
          meals: MEALS.map(m => ({ name: m.he, time: d.meals[m.key] || "тАФ" })),
          fields: {
            whoCooks: { label: "╫Ю╫Щ ╫Ю╫С╫й╫Ь?", value: d.whoCooks },
            workerCooksForSelf: { label: "╫Ф╫Р╫Э ╫Ф╫в╫Х╫С╫У/╫к ╫Ю╫С╫й╫Ь/╫к ╫Т╫Э ╫Ь╫в╫ж╫Ю╫Х/╫Ф?", value: yesNo(d.workerCooksForSelf) },
            forbiddenFood: { label: "╫Ю╫Ф ╫Р╫б╫Х╫и ╫Ь╫С╫й╫Ь / ╫Ь╫Ф╫Т╫Щ╫й ╫Ь╫Ю╫Ш╫Х╫д╫Ь?", value: d.forbiddenFood },
            whoShops: { label: "╫Ю╫Щ ╫в╫Х╫и╫Ъ ╫Р╫к ╫Ф╫з╫а╫Щ╫Х╫к?", value: d.whoShops },
            shoppingPayment: { label: "╫Р╫Х╫д╫Я ╫к╫й╫Ь╫Х╫Э ╫С╫з╫а╫Щ╫Х╫к", value: d.shoppingPayment },
            workerShopsAlone: { label: "╫Ф╫Р╫Э ╫Ф╫в╫Х╫С╫У/╫к ╫Щ╫Х╫ж╫Р ╫Ь╫з╫а╫Х╫к ╫Ь╫С╫У?", value: yesNo(d.workerShopsAlone) },
            patientDuringShop: { label: "╫Ю╫Ф ╫з╫Х╫и╫Ф ╫в╫Э ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к ╫С╫Ц╫Ю╫Я ╫Ф╫з╫а╫Щ╫Х╫к?", value: d.patientDuringShop },
            receiptRequired: { label: "╫Ф╫Р╫Э ╫а╫У╫и╫й╫к ╫з╫С╫Ь╫Ф / ╫У╫Щ╫Х╫Х╫Ч?", value: yesNo(d.receiptRequired) },
          }
        },
        s3b: {
          title: "╫Ф╫й╫Т╫Ч╫к ╫Ь╫Щ╫Ь╫Ф",
          fields: {
            nightWatch: { label: "╫Ф╫Р╫Э ╫а╫У╫и╫й╫к ╫Ф╫й╫Т╫Ч╫Ф ╫С╫Ь╫Щ╫Ь╫Ф?", value: d.nightWatch },
            minSleepHours: { label: "╫й╫в╫Х╫к ╫й╫Щ╫а╫Ф ╫Ю╫Щ╫а╫Щ╫Ю╫Ь╫Щ╫Х╫к ╫Ю╫Х╫С╫Ш╫Ч╫Х╫к", value: d.minSleepHours },
            sleepFrom: { label: "╫Ю╫Ф╫й╫в╫Ф", value: d.sleepFrom },
            sleepTo: { label: "╫в╫У ╫Ф╫й╫в╫Ф", value: d.sleepTo },
            nightReplacement: { label: "╫Ю╫Щ ╫Ю╫Ч╫Ь╫Щ╫г ╫С╫Ь╫Щ╫Ь╫Х╫к ╫б╫Х╫г ╫й╫С╫Х╫в?", value: d.nightReplacement },
            nightCallMethod: { label: "╫Ы╫Щ╫ж╫У ╫Ю╫в╫Щ╫и╫Щ╫Э ╫Р╫к ╫Ф╫в╫Х╫С╫У/╫к?", value: d.nightCallMethod },
            nightCompensation: { label: "╫Ф╫Р╫Э ╫Щ╫й ╫д╫Щ╫ж╫Х╫Щ ╫в╫Ь ╫Ь╫Щ╫Ь╫Х╫к ╫в╫Э ╫з╫и╫Щ╫Р╫Х╫к?", value: yesNo(d.nightCompensation) },
            nightCompDetails: { label: "╫д╫и╫Ш╫Щ ╫Ф╫д╫Щ╫ж╫Х╫Щ", value: d.nightCompDetails },
          }
        },
        s4: {
          title: "╫Ы╫Ь╫Ь╫Щ ╫Ф╫С╫Щ╫к",
          fields: {
            phonePolicy: { label: "╫Ю╫У╫Щ╫а╫Щ╫Х╫к ╫й╫Щ╫Ю╫Х╫й ╫С╫Ш╫Ь╫д╫Х╫Я ╫а╫Щ╫Щ╫У", value: d.phonePolicy },
            phoneForbiddenWhen: { label: "╫Ю╫к╫Щ ╫Р╫б╫Х╫и ╫Ь╫Ф╫й╫к╫Ю╫й ╫С╫Ш╫Ь╫д╫Х╫Я?", value: d.phoneForbiddenWhen },
            smoking: { label: "╫в╫Щ╫й╫Х╫Я", value: yesNo(d.smoking) },
            smokingArea: { label: "╫Р╫Ц╫Х╫и ╫Ю╫Х╫к╫и ╫Ь╫в╫Щ╫й╫Х╫Я", value: d.smokingArea },
            guests: { label: "╫Р╫Щ╫и╫Х╫Ч ╫Р╫Х╫и╫Ч╫Щ╫Э", value: d.guests },
            kosher: { label: "╫Ы╫й╫и╫Х╫к / ╫Ф╫а╫Ч╫Щ╫Х╫к ╫У╫к ╫С╫С╫Щ╫к", value: yesNo(d.kosher) },
            kosherDetails: { label: "╫д╫и╫Ш╫Щ ╫Ы╫й╫и╫Х╫к", value: d.kosherDetails },
          }
        },
        s5: {
          title: "╫к╫а╫Р╫Щ ╫Ф╫в╫б╫з╫Ф",
          fields: {
            salary: { label: "╫й╫Ы╫и ╫Ч╫Х╫У╫й╫Щ", value: d.salary },
            payDay: { label: "╫Щ╫Х╫Э ╫к╫й╫Ь╫Х╫Э", value: d.payDay },
            pocketMoney: { label: "╫У╫Ю╫Щ ╫Ы╫Щ╫б ╫й╫С╫Х╫в╫Щ╫Щ╫Э", value: d.pocketMoney },
            restDay: { label: "╫Щ╫Х╫Э ╫Ю╫а╫Х╫Ч╫Ф ╫й╫С╫Х╫в╫Щ", value: d.restDay },
            leaveNotice: { label: "╫Ф╫Х╫У╫в╫Ф ╫Ю╫и╫Р╫й ╫Ь╫Ч╫Х╫д╫й╫Ф (╫Щ╫Ю╫Щ╫Э)", value: d.leaveNotice },
            leaveChannel: { label: "╫в╫и╫Х╫е ╫Ф╫Х╫У╫в╫Ф ╫в╫Ь ╫Ч╫Х╫д╫й╫Ф", value: d.leaveChannel },
            sickNotice: { label: "╫а╫Х╫Ф╫Ь ╫Ф╫Х╫У╫в╫Ф ╫в╫Ь ╫Ю╫Ч╫Ь╫Ф", value: d.sickNotice },
            dailyRest: { label: "╫й╫в╫Х╫к ╫Ю╫а╫Х╫Ч╫Ф ╫Щ╫Х╫Ю╫Щ╫Х╫к", value: d.dailyRest },
            terminationLaw: { label: "╫Ф╫Х╫У╫в╫Ф ╫Ю╫Х╫з╫У╫Ю╫к ╫Ь╫д╫Щ ╫Ч╫Х╫з", value: "╫в╫У 3 ╫Ч╫Х╫У╫й╫Щ╫Э: ╫й╫С╫Х╫в | ╫Ч╫Х╫У╫й 4тАУ6: 14 ╫Щ╫Х╫Э | ╫Ч╫Х╫У╫й 7тАУ12: 21 ╫Щ╫Х╫Э | ╫Ю╫в╫Ь ╫й╫а╫Ф: ╫Ч╫Х╫У╫й ╫Щ╫Ю╫Щ╫Э" },
            holidaysSelected: { label: "9 ╫Щ╫Ю╫Щ ╫Ч╫Т тАФ ╫а╫С╫Ч╫и╫Х?", value: yesNo(d.holidaysSelected) },
          }
        },
        s6: {
          title: "╫а╫Х╫Ф╫Ь╫Щ ╫Ч╫Щ╫и╫Х╫Э",
          fields: {
            fallProtocol: { label: "╫Ю╫Ф ╫Ь╫в╫й╫Х╫к ╫Р╫Э ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к ╫а╫Х╫д╫Ь/╫к?", value: d.fallProtocol },
            refusalProtocol: { label: "╫Ю╫Ф ╫Ь╫в╫й╫Х╫к ╫Р╫Э ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к ╫Ю╫б╫и╫С/╫к ╫Ь╫Р╫Ы╫Х╫Ь / ╫Ь╫к╫и╫Х╫д╫Х╫к?", value: d.refusalProtocol },
            contactOrder: { label: "╫б╫У╫и ╫в╫У╫Щ╫д╫Х╫Щ╫Х╫к тАФ ╫Ю╫Щ ╫Ь╫Ф╫к╫з╫й╫и ╫и╫Р╫й╫Х╫Я?", value: d.contactOrder },
            distressButton: { label: "╫Ь╫Ч╫ж╫Я ╫Ю╫ж╫Х╫з╫Ф / ╫й╫в╫Х╫Я ╫Ч╫Ы╫Э", value: d.distressButton === "yes" ? "╫Щ╫й" : d.distressButton === "no" ? "╫Р╫Щ╫Я" : "тАФ" },
            distressDetails: { label: "╫д╫и╫Ш╫Щ ╫Ь╫Ч╫ж╫Я ╫Ф╫Ю╫ж╫Х╫з╫Ф", value: d.distressDetails },
            ambulanceAuto: { label: "╫Ф╫Ц╫в╫з╫к ╫Р╫Ю╫С╫Х╫Ь╫а╫б", value: d.ambulanceAuto === "immediate" ? "╫Ы╫Я тАФ ╫Ю╫Щ╫У, ╫Ь╫Ь╫Р ╫к╫Щ╫Р╫Х╫Э" : d.ambulanceAuto === "coord" ? "╫Ы╫Я тАФ ╫Ь╫Р╫Ч╫и ╫а╫Щ╫б╫Щ╫Х╫Я ╫Щ╫ж╫Щ╫и╫к ╫з╫й╫и ╫в╫Э ╫Ф╫Ю╫й╫д╫Ч╫Ф" : d.ambulanceAuto === "family_first" ? "╫и╫з ╫Ь╫Р╫Ч╫и ╫Р╫Щ╫й╫Х╫и ╫Ф╫Ю╫й╫д╫Ч╫Ф" : "тАФ" },
          }
        },
        s7: {
          title: "╫Ф╫в╫и╫Х╫к ╫а╫Х╫б╫д╫Х╫к",
          openNotes: { label: "╫Ф╫в╫и╫Х╫к ╫Ч╫Х╫д╫й╫Щ╫Х╫к", value: d.openNotes },
        }
      }
    };
  };

  const generate = async () => {
    setView("loading");
    const payload = buildTranslationPayload();
    try {
      // Determine what needs translating
      // Hebrew payload = payload (already Hebrew)
      // Right column = Hebrew always (if he is involved), else English
      // Left column = the non-Hebrew language

      const needsTranslation = [];
      if (baseLang === "en") needsTranslation.push("en");
      if (extraLang !== "none") needsTranslation.push(extraLang);

      const translations = {};
      await Promise.all([...new Set(needsTranslation)].map(async l => {
        translations[l] = await translateTo(payload, l);
      }));

      const getP = (l) => l === "he" ? payload : translations[l];

      if (extraLang === "none") {
        // Single language
        setReport({ mode: "single", lang: baseLang, singlePayload: getP(baseLang) });
      } else {
        // Bilingual: Hebrew always RIGHT, other language always LEFT
        // baseLang must be "he" when extraLang is set (English alone has no extra)
        const rightLang = "he";
        const leftLang = extraLang === "none" ? baseLang : extraLang;
        // Special case: if baseLang=en and extraLang set тЖТ left=extraLang, right=en
        const actualRight = baseLang === "he" ? "he" : baseLang;
        const actualLeft  = baseLang === "he" ? extraLang : extraLang;
        setReport({
          mode: "pair",
          leftLang: actualLeft, rightLang: actualRight,
          leftPayload: getP(actualLeft), rightPayload: getP(actualRight),
        });
      }
      setView("report");
    } catch (e) {
      alert("╫й╫Т╫Щ╫Р╫Ф ╫С╫к╫и╫Т╫Х╫Э. ╫а╫б╫Ф ╫й╫Х╫С.");
      setView("form");
    }
  };

  if (view === "loading") return (
    <>
      <style>{STYLE}</style>
      <div className="loading">╫Ю╫к╫и╫Т╫Э ╫Х╫Ю╫Щ╫Щ╫ж╫и ╫У╫Х╫Ч...</div>
    </>
  );

  if (view === "report") return <Report report={report} form={form} onBack={() => setView("form")} />;

  return (
    <FormCtx.Provider value={{ form, upd }}>
    <>
      <style>{STYLE}</style>
      <div className="wrap print-hide">
        <div className="main-title">╫к╫Щ╫Р╫Х╫Э ╫ж╫Щ╫д╫Щ╫Х╫к</div>
        <div className="main-sub">╫а╫б╫д╫Ч ╫Ь╫Ч╫Х╫Ц╫Ф тАФ ╫в╫Х╫С╫У/╫к ╫б╫Щ╫в╫Х╫У</div>

        {/* тФАтФА INTRO тФАтФА */}
        <div style={{
          border: "1.5px solid #ccc",
          borderRadius: "10px",
          padding: "28px 32px",
          marginBottom: "48px",
          background: "#fafafa",
          lineHeight: "1.85",
        }}>
          <p style={{ fontSize: "14px", fontWeight: 600, marginBottom: "10px", color: "#111" }}>
            ╫Ь╫д╫а╫Щ╫Ы╫Э ╫б╫Щ╫Ы╫Х╫Э ╫к╫Щ╫Р╫Х╫Э ╫Ф╫ж╫Щ╫д╫Щ╫Х╫к тАУ ╫Ф╫С╫б╫Щ╫б ╫Ь╫й╫Х╫к╫д╫Х╫к ╫Ю╫Х╫ж╫Ь╫Ч╫к.
          </p>
          <p style={{ fontSize: "13px", color: "#444" }}>
            ╫Ю╫б╫Ю╫Ъ ╫Ц╫Ф ╫Р╫Щ╫а╫Х ╫и╫з ╫б╫Щ╫Ы╫Х╫Э ╫Ш╫Ы╫а╫Щ, ╫Р╫Ь╫Р ╫Ф╫к╫й╫к╫Щ╫к ╫Ь╫Ф╫ж╫Ь╫Ч╫к ╫Ф╫Ш╫Щ╫д╫Х╫Ь ╫Ф╫б╫Щ╫в╫Х╫У╫Щ ╫С╫С╫Щ╫к╫Ы╫Э. ╫Ю╫Ш╫и╫к╫Х ╫Ф╫Щ╫Р ╫Ь╫Т╫й╫и ╫в╫Ь ╫д╫в╫и╫Щ ╫Ф╫и╫Т╫Ь╫Щ╫Э ╫Х╫Ф╫й╫з╫д╫Х╫к ╫в╫Х╫Ь╫Э, ╫Ь╫Ю╫а╫Х╫в ╫Р╫Щ-╫Ф╫С╫а╫Х╫к ╫Х╫Ь╫Щ╫Щ╫ж╫и ╫б╫С╫Щ╫С╫к ╫в╫С╫Х╫У╫Ф ╫а╫в╫Щ╫Ю╫Ф. ╫Ц╫Ф╫Х ╫Ф╫ж╫в╫У ╫Ф╫и╫Р╫й╫Х╫Я ╫С╫У╫и╫Ъ ╫Ь╫С╫а╫Щ╫Щ╫к ╫Р╫Ю╫Х╫Я ╫Ф╫У╫У╫Щ ╫Х╫Ь╫Щ╫ж╫Щ╫и╫к ╫й╫Т╫и╫Ф ╫Щ╫ж╫Щ╫С╫Ф ╫Х╫Ю╫Х╫к╫Р╫Ю╫к ╫Р╫Щ╫й╫Щ╫к, ╫Ф╫Ю╫Т╫У╫Щ╫и╫Ф ╫С╫С╫Щ╫и╫Х╫и ╫Р╫к ╫Ф╫Ю╫ж╫С ╫Ф╫и╫д╫Х╫Р╫Щ, ╫Ь╫Х╫Ч╫Х╫к ╫Ф╫Ц╫Ю╫а╫Щ╫Э ╫Х╫Ы╫Ь╫Ь╫Щ ╫Ф╫С╫Щ╫к.
          </p>
        </div>

        {/* тФАтФА LANG SELECTOR тФАтФА */}
        {(() => {
          const LNAME = { he:"╫в╫С╫и╫Щ╫к", en:"English", uz:"O╩╗zbekcha", hi:"рд╣рд┐рдиреНрджреА" };
          const Chip = ({ val, selected, onClick, children }) => (
            <button onClick={onClick} style={{
              padding:"9px 20px", border:`1.5px solid ${selected?"#111":"#ddd"}`,
              borderRadius:6, background: selected?"#111":"#fff",
              color: selected?"#fff":"#333", fontSize:13, cursor:"pointer",
              fontFamily:"inherit", fontWeight: selected?600:400, transition:"all 0.15s"
            }}>{children || LNAME[val]}</button>
          );
          // Extra lang options depend on baseLang
          const extraOpts = baseLang === "he"
            ? [["none","╫Ь╫Ь╫Р"],["en","English"],["uz","O╩╗zbekcha"],["hi","рд╣рд┐рдиреНрджреА"]]
            : [["none","╫Ь╫Ь╫Р"],["uz","O╩╗zbekcha"],["hi","рд╣рд┐рдиреНрджреА"]];

          const previewLine = () => {
            if (extraLang === "none") return `ЁЯУД ╫У╫Х╫Ч ╫С╫й╫д╫Ф ╫Р╫Ч╫к: ${LNAME[baseLang]}`;
            const lName = LNAME[extraLang];
            return baseLang === "he"
              ? `ЁЯУД ╫в╫Ю╫Х╫У╫Ф ╫Щ╫Ю╫Щ╫Я: ╫в╫С╫и╫Щ╫к  |  ╫в╫Ю╫Х╫У╫Ф ╫й╫Ю╫Р╫Ь: ${lName}`
              : `ЁЯУД ╫в╫Ю╫Х╫У╫Ф ╫Щ╫Ю╫Щ╫Я: English  |  ╫в╫Ю╫Х╫У╫Ф ╫й╫Ю╫Р╫Ь: ${lName}`;
          };

          return (
            <div style={{ marginBottom:52, padding:"28px", border:"1px solid #ddd", borderRadius:8, background:"#fafafa" }}>
              <div style={{ fontSize:13, fontWeight:700, marginBottom:22, color:"#111" }}>
                ╫С╫Р╫Щ╫Ц╫Х ╫й╫д╫Ф ╫к╫и╫ж╫Х ╫Ь╫Ф╫д╫Щ╫з ╫Р╫к ╫Ф╫У╫Х╫Ч?
              </div>

              {/* Step 1 тАФ Base language */}
              <div style={{ marginBottom:24 }}>
                <div style={{ fontSize:11, fontWeight:600, color:"#888", letterSpacing:1, marginBottom:10 }}>
                  ╫й╫д╫Ф ╫и╫Р╫й╫Щ╫к
                </div>
                <div style={{ display:"flex", gap:10 }}>
                  <Chip val="he" selected={baseLang==="he"} onClick={() => { setBaseLang("he"); setExtraLang("none"); }} />
                  <Chip val="en" selected={baseLang==="en"} onClick={() => { setBaseLang("en"); setExtraLang("none"); }} />
                </div>
                <div style={{ fontSize:11, color:"#aaa", marginTop:8 }}>
                  {baseLang==="he" ? "╫в╫С╫и╫Щ╫к ╫к╫Х╫д╫Щ╫в ╫к╫Ю╫Щ╫У ╫С╫в╫Ю╫Х╫У╫Ф ╫Ф╫Щ╫Ю╫а╫Щ╫к" : "English will appear on the right column"}
                </div>
              </div>

              {/* Step 2 тАФ Optional second language */}
              <div>
                <div style={{ fontSize:11, fontWeight:600, color:"#888", letterSpacing:1, marginBottom:10 }}>
                  ╫й╫д╫Ф ╫а╫Х╫б╫д╫к (╫Р╫Х╫д╫ж╫Щ╫Х╫а╫Ь╫Щ) тАФ ╫к╫Х╫д╫Щ╫в ╫С╫в╫Ю╫Х╫У╫Ф ╫Ф╫й╫Ю╫Р╫Ь╫Щ╫к
                </div>
                <div style={{ display:"flex", gap:10, flexWrap:"wrap" }}>
                  {extraOpts.map(([k,l]) => (
                    <Chip key={k} val={k} selected={extraLang===k} onClick={() => setExtraLang(k)}>
                      {l}
                    </Chip>
                  ))}
                </div>
              </div>

              {/* Preview */}
              <div style={{ marginTop:20, fontSize:12, color:"#555", borderTop:"1px solid #e8e8e8", paddingTop:14 }}>
                {previewLine()}
              </div>
            </div>
          );
        })()}

        {/* тФАтФА SEC 0 тФАтФА */}
        <div className="sec">
          <div className="sec-title"><span className="sec-num">01</span> ╫д╫и╫Ш╫Щ╫Э ╫Ы╫Ь╫Ь╫Щ╫Щ╫Э</div>
          <div className="grid2">
            <R field="patientName" label="╫й╫Э ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к" />
            <R field="patientAge" label="╫Т╫Щ╫Ь" />
            <R field="workerName" label="╫й╫Э ╫Ф╫в╫Х╫С╫У/╫к" />
            <R field="workerOrigin" label="╫Р╫и╫е ╫Ю╫Х╫ж╫Р" />
            <R field="agency" label="╫к╫Р╫Т╫Щ╫У" />
            <R field="startDate" label="╫к╫Р╫и╫Щ╫Ъ ╫к╫Ч╫Щ╫Ь╫к ╫в╫С╫Х╫У╫Ф" type="date" />
          </div>
        </div>

        {/* тФАтФА SEC 1 тФАтФА */}
        <div className="sec">
          <div className="sec-title"><span className="sec-num">02</span> ╫Ф╫Щ╫Ы╫и╫Х╫к ╫Ф╫У╫У╫Щ╫к</div>
          <R field="patientStory" label="╫Ю╫Щ ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к тАФ ╫з╫ж╫к ╫в╫Ь ╫Ф╫Р╫У╫Э" hint="(╫Ь╫Р ╫и╫з ╫Ф╫Ю╫ж╫С ╫Ф╫и╫д╫Х╫Р╫Щ тАФ ╫Ю╫Ф ╫Ф╫Х╫Р/╫Ф╫Щ╫Р ╫Р╫Х╫Ф╫С/╫к, ╫Ю╫Ф ╫в╫С╫и/╫Ф)" type="textarea" />
          <R field="patientImportant" label="╫Ю╫Ф ╫Ч╫й╫Х╫С ╫Ь╫Х/╫Ь╫Ф ╫С╫Щ╫Х╫Ю╫Щ╫Х╫Э?" type="textarea" />
          <R field="patientMood" label="╫Ю╫Ф ╫Ю╫й╫Ю╫Ч ╫Р╫Х╫к╫Х/╫Р╫Х╫к╫Ф? ╫Ю╫Ф ╫в╫Ь╫Х╫Ь ╫Ь╫Ф╫и╫Т╫Щ╫Ц?" type="textarea" />
          <R field="workerBackground" label="╫и╫з╫в ╫Р╫Щ╫й╫Щ ╫й╫Ь ╫Ф╫в╫Х╫С╫У/╫к (╫Ю╫й╫д╫Ч╫Ф, ╫Щ╫Ь╫У╫Щ╫Э, ╫Ю╫ж╫С)" type="textarea" />
          <R field="workerExpectations" label="╫ж╫Щ╫д╫Щ╫Х╫к ╫Ф╫в╫Х╫С╫У/╫к ╫Ю╫Ф╫Ю╫й╫и╫Ф ╫Х╫Ю╫Ф╫Ю╫й╫д╫Ч╫Ф" type="textarea" />
        </div>

        {/* тФАтФА SEC 2 тФАтФА */}
        <div className="sec">
          <div className="sec-title"><span className="sec-num">03</span> ╫Ю╫ж╫С ╫и╫д╫Х╫Р╫Щ ╫Х╫к╫д╫з╫Щ╫У╫Щ ╫Ш╫Щ╫д╫Х╫Ь</div>
          <table className="task-table">
            <thead>
              <tr>
                <th>╫к╫д╫з╫Щ╫У</th>
                <th>╫Ы╫Ь╫Х╫Ь?</th>
                <th>╫Ф╫в╫и╫Х╫к / ╫Р╫Х╫д╫Я ╫С╫Щ╫ж╫Х╫в</th>
              </tr>
            </thead>
            <tbody>
              {TASKS.map(t => (
                <tr key={t.key}>
                  <td>{t.he}</td>
                  <td>
                    <select value={form.tasks[t.key]?.included || ""} onChange={e => updTask(t.key, "included", e.target.value)}>
                      <option value="">тАФ</option>
                      <option value="yes">╫Ы╫Я</option>
                      <option value="no">╫Ь╫Р</option>
                      <option value="sometimes">╫Ь╫д╫Щ ╫Ф╫ж╫Х╫и╫Ъ</option>
                    </select>
                  </td>
                  <td><input type="text" value={form.tasks[t.key]?.notes || ""} onChange={e => updTask(t.key, "notes", e.target.value)} /></td>
                </tr>
              ))}
            </tbody>
          </table>
          <div style={{ marginTop: 24 }}>
            <R field="notExpected" label="╫Ю╫Ф ╫Р╫Щ╫а╫Х ╫Ю╫ж╫Х╫д╫Ф ╫Ю╫Ф╫в╫Х╫С╫У/╫к (╫Ч╫й╫Х╫С ╫Ь╫Ю╫а╫Х╫в ╫Р╫Щ-╫Ф╫С╫а╫Х╫к)" type="textarea" />
          </div>
        </div>

        {/* тФАтФА SEC 3 тАФ MEALS тФАтФА */}
        <div className="sec">
          <div className="sec-title"><span className="sec-num">04</span> ╫б╫У╫и ╫Щ╫Х╫Э тАФ ╫Р╫и╫Х╫Ч╫Х╫к ╫Х╫С╫Щ╫й╫Х╫Ь</div>
          <table className="task-table">
            <thead><tr><th>╫Р╫и╫Х╫Ч╫Ф</th><th>╫й╫в╫Ф</th></tr></thead>
            <tbody>
              {MEALS.map(m => (
                <tr key={m.key}>
                  <td>{m.he}</td>
                  <td><input type="text" placeholder="╫Ь╫У╫Х╫Т╫Ю╫Ф: 08:00" value={form.meals[m.key]} onChange={e => updMeal(m.key, e.target.value)} /></td>
                </tr>
              ))}
            </tbody>
          </table>
          <div style={{ marginTop: 24 }}>
            <R field="whoCooks" label="╫Ю╫Щ ╫Р╫Ч╫и╫Р╫Щ ╫в╫Ь ╫Ф╫С╫Щ╫й╫Х╫Ь?" type="radio" options={[{ v: "worker", l: "╫Ф╫в╫Х╫С╫У/╫к" }, { v: "family", l: "╫С╫Я/╫С╫к ╫Ю╫й╫д╫Ч╫Ф" }, { v: "both", l: "╫й╫а╫Щ╫Ф╫Э ╫Ь╫б╫Щ╫и╫Х╫Т╫Щ╫Я" }]} />
            <R field="workerCooksForSelf" label="╫Ф╫Р╫Э ╫Ф╫в╫Х╫С╫У/╫к ╫Ю╫С╫й╫Ь/╫к ╫Т╫Э ╫Ь╫в╫ж╫Ю╫Х/╫Ф?" type="radio" options={[{ v: "yes", l: "╫Ы╫Я" }, { v: "no", l: "╫Ь╫Р" }, { v: "coord", l: "╫С╫к╫Щ╫Р╫Х╫Э" }]} />
            <R field="forbiddenFood" label="╫Ю╫Ф ╫Р╫б╫Х╫и ╫Ь╫С╫й╫Ь / ╫Ь╫Ф╫Т╫Щ╫й ╫Ь╫Ю╫Ш╫Х╫д╫Ь/╫к?" type="textarea" />
          </div>
        </div>

        {/* тФАтФА SEC 3B тАФ SHOPPING тФАтФА */}
        <div className="sec">
          <div className="sec-title"><span className="sec-num">05</span> ╫з╫а╫Щ╫Х╫к</div>
          <R field="whoShops" label="╫Ю╫Щ ╫Р╫Ч╫и╫Р╫Щ ╫в╫Ь ╫Ф╫з╫а╫Щ╫Х╫к?" type="radio" options={[{ v: "worker", l: "╫Ф╫в╫Х╫С╫У/╫к" }, { v: "family", l: "╫С╫Я/╫С╫к ╫Ю╫й╫д╫Ч╫Ф" }, { v: "both", l: "╫й╫а╫Щ╫Ф╫Э" }]} />
          <R field="shoppingPayment" label="╫Р╫Х╫д╫Я ╫к╫й╫Ь╫Х╫Э ╫С╫з╫а╫Щ╫Х╫к" type="radio" options={[{ v: "card", l: "╫Ы╫и╫Ш╫Щ╫б ╫Р╫й╫и╫Р╫Щ" }, { v: "cash", l: "╫Ю╫Ц╫Х╫Ю╫Я" }, { v: "online", l: "╫Ф╫Ц╫Ю╫а╫Ф ╫Р╫Х╫а╫Ь╫Щ╫Щ╫Я" }]} />
          <R field="workerShopsAlone" label="╫Ф╫Р╫Э ╫Ф╫в╫Х╫С╫У/╫к ╫Щ╫Ы╫Х╫Ь/╫Ф ╫Ь╫ж╫Р╫к ╫Ь╫з╫а╫Х╫к ╫Ь╫С╫У?" type="radio" options={[{ v: "yes", l: "╫Ы╫Я" }, { v: "no", l: "╫Ь╫Р тАФ ╫и╫з ╫в╫Э ╫Ь╫Щ╫Х╫Х╫Щ" }]} />
          <R field="patientDuringShop" label="╫Ю╫Ф ╫з╫Х╫и╫Ф ╫в╫Э ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к ╫С╫Ц╫Ю╫Я ╫Ф╫з╫а╫Щ╫Х╫к?" type="radio" options={[{ v: "family", l: "╫а╫й╫Р╫и/╫к ╫в╫Э ╫С╫Я/╫С╫к ╫Ю╫й╫д╫Ч╫Ф" }, { v: "comes", l: "╫Ю╫Т╫Щ╫в/╫Ф ╫Щ╫Ч╫У ╫Ь╫з╫а╫Щ╫Х╫к" }]} />
          <R field="receiptRequired" label="╫Ф╫Р╫Э ╫а╫У╫и╫й╫к ╫з╫С╫Ь╫Ф / ╫У╫Щ╫Х╫Х╫Ч?" type="radio" options={[{ v: "yes", l: "╫Ы╫Я" }, { v: "no", l: "╫Ь╫Р" }]} />
        </div>

        {/* тФАтФА SEC 3C тАФ NIGHT тФАтФА */}
        <div className="sec">
          <div className="sec-title"><span className="sec-num">06</span> ╫Ф╫й╫Т╫Ч╫к ╫Ь╫Щ╫Ь╫Ф</div>
          <R field="nightWatch" label="╫Ф╫Р╫Э ╫а╫У╫и╫й╫к ╫Ф╫й╫Т╫Ч╫Ф ╫С╫Ь╫Щ╫Ь╫Ф?" type="radio" options={[{ v: "yes", l: "╫Ы╫Я" }, { v: "no", l: "╫Ь╫Р" }, { v: "sometimes", l: "╫Ю╫ж╫С╫Щ╫к тАФ ╫Ь╫д╫Щ ╫Ф╫ж╫Х╫и╫Ъ" }]} />
          {form.nightWatch !== "no" && <>
            <div className="alert">
              <p><strong>╫Ф╫ж╫Ф╫и╫к ╫Ф╫в╫Х╫С╫У/╫к:</strong> ╫Щ╫У╫Х╫в ╫Ь╫Щ ╫Ы╫Щ ╫Щ╫Щ╫к╫Ы╫а╫Х ╫з╫и╫Щ╫Р╫Х╫к ╫Ь╫Щ╫Ь╫Ф ╫Х╫в╫Ь╫Щ ╫Ь╫Ф╫Т╫Щ╫С ╫Р╫Ь╫Щ╫Ф╫Я. ╫Р╫а╫Щ ╫Ю╫С╫Щ╫Я/╫Ф ╫й╫Ц╫Ф ╫Ч╫Ь╫з ╫Ю╫Ф╫к╫д╫з╫Щ╫У.</p>
              <p><strong>╫Ф╫к╫Ч╫Щ╫Щ╫С╫Х╫к ╫Ф╫Ю╫й╫д╫Ч╫Ф:</strong> ╫Р╫а╫Х ╫Ю╫к╫Ч╫Щ╫Щ╫С╫Щ╫Э ╫Ь╫в╫й╫Х╫к ╫Ы╫Ь ╫й╫С╫Щ╫Ы╫Х╫Ь╫к╫а╫Х ╫Ь╫Р╫д╫й╫и ╫Ь╫в╫Х╫С╫У/╫к ╫й╫в╫Х╫к ╫Ю╫а╫Х╫Ч╫Ф ╫и╫ж╫Щ╫д╫Х╫к, ╫Х╫Ь╫б╫У╫Щ╫и ╫Ч╫Ь╫Х╫д╫Ф ╫С╫Ь╫Щ╫Ь╫Х╫к ╫й╫С╫Ф╫Э ╫Ф╫У╫С╫и ╫Р╫д╫й╫и╫Щ.</p>
            </div>
            <div className="grid3">
              <R field="minSleepHours" label="╫й╫в╫Х╫к ╫й╫Щ╫а╫Ф ╫Ю╫Щ╫а╫Щ╫Ю╫Ь╫Щ╫Х╫к ╫Ю╫Х╫С╫Ш╫Ч╫Х╫к" />
              <R field="sleepFrom" label="╫Ю╫Ф╫й╫в╫Ф" />
              <R field="sleepTo" label="╫в╫У ╫Ф╫й╫в╫Ф" />
            </div>
            <R field="nightReplacement" label="╫Ю╫Щ ╫Ю╫Ч╫Ь╫Щ╫г ╫С╫Ь╫Щ╫Ь╫Х╫к ╫б╫Х╫г ╫й╫С╫Х╫в?" />
            <R field="nightCallMethod" label="╫Ы╫Щ╫ж╫У ╫Ю╫в╫Щ╫и╫Щ╫Э ╫Р╫к ╫Ф╫в╫Х╫С╫У/╫к?" type="radio" options={[{ v: "intercom", l: "╫Р╫Щ╫а╫Ш╫и╫з╫Х╫Э" }, { v: "knock", l: "╫У╫д╫Щ╫з╫Ф" }, { v: "phone", l: "╫Ш╫Ь╫д╫Х╫Я" }]} />
            <R field="nightCompensation" label="╫Ф╫Р╫Э ╫Щ╫й ╫д╫Щ╫ж╫Х╫Щ ╫в╫Ь ╫Ь╫Щ╫Ь╫Х╫к ╫в╫Э ╫з╫и╫Щ╫Р╫Х╫к?" type="radio" options={[{ v: "yes", l: "╫Ы╫Я" }, { v: "no", l: "╫Ь╫Р" }]} />
            {form.nightCompensation === "yes" && <R field="nightCompDetails" label="╫д╫и╫Ш╫Щ ╫Ф╫д╫Щ╫ж╫Х╫Щ" />}
          </>}
        </div>

        {/* тФАтФА SEC 4 тАФ HOUSE RULES тФАтФА */}
        <div className="sec">
          <div className="sec-title"><span className="sec-num">07</span> ╫Ы╫Ь╫Ь╫Щ ╫Ф╫С╫Щ╫к</div>
          <R field="phonePolicy" label="╫Ю╫У╫Щ╫а╫Щ╫Х╫к ╫й╫Щ╫Ю╫Х╫й ╫С╫Ш╫Ь╫д╫Х╫Я ╫а╫Щ╫Щ╫У" type="radio" options={[{ v: "rest", l: "╫Ю╫Х╫к╫и ╫С╫Ц╫Ю╫Я ╫Ю╫а╫Х╫Ч╫к ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к" }, { v: "free", l: "╫Ю╫Х╫к╫и ╫С╫Ч╫Х╫д╫й╫Щ╫Х╫к" }, { v: "restricted", l: "╫Ю╫Х╫Т╫С╫Ь тАФ ╫и╫Р╫Ф ╫Ф╫в╫и╫Х╫к" }]} />
          <R field="phoneForbiddenWhen" label="╫Ю╫к╫Щ ╫Р╫б╫Х╫и ╫С╫Ф╫Ч╫Ь╫Ш ╫Ь╫Ф╫й╫к╫Ю╫й ╫С╫Ш╫Ь╫д╫Х╫Я?" hint="(╫Ю╫з╫Ь╫Ч╫к, ╫Р╫и╫Х╫Ч╫Х╫к, ╫Ф╫Ь╫Щ╫Ы╫Ф ╫С╫Ч╫Х╫е, ╫Ю╫к╫Я ╫к╫и╫Х╫д╫Х╫к...)" type="textarea" />
          <R field="smoking" label="╫в╫Щ╫й╫Х╫Я" type="radio" options={[{ v: "yes", l: "╫Ю╫Х╫к╫и" }, { v: "no", l: "╫Р╫б╫Х╫и ╫Ь╫Ч╫Ь╫Х╫Ш╫Щ╫Я" }, { v: "outside", l: "╫Ю╫Ч╫Х╫е ╫Ь╫С╫Щ╫к ╫С╫Ь╫С╫У" }]} />
          {form.smoking === "yes" || form.smoking === "outside" ? <R field="smokingArea" label="╫Р╫Ц╫Х╫и ╫Ю╫Х╫к╫и ╫Ь╫в╫Щ╫й╫Х╫Я" /> : null}
          <R field="guests" label="╫Р╫Щ╫и╫Х╫Ч ╫Ч╫С╫и╫Щ╫Э / ╫Ю╫й╫д╫Ч╫Ф ╫й╫Ь ╫Ф╫в╫Х╫С╫У/╫к" type="radio" options={[{ v: "yes", l: "╫Ю╫Х╫к╫и" }, { v: "no", l: "╫Р╫б╫Х╫и" }, { v: "coord", l: "╫С╫к╫Щ╫Р╫Х╫Э ╫Ю╫и╫Р╫й" }]} />
          <R field="kosher" label="╫Ф╫Р╫Э ╫Щ╫й ╫Ы╫й╫и╫Х╫к / ╫Ф╫а╫Ч╫Щ╫Х╫к ╫У╫к ╫С╫С╫Щ╫к?" type="radio" options={[{ v: "yes", l: "╫Ы╫Я" }, { v: "no", l: "╫Ь╫Р" }]} />
          {form.kosher === "yes" && <R field="kosherDetails" label="╫д╫и╫Ш╫Щ ╫Ы╫й╫и╫Х╫к (╫Ф╫д╫и╫У╫к ╫Ы╫Ь╫Щ╫Э, ╫Ю╫Х╫ж╫и╫Щ╫Э ╫Р╫б╫Х╫и╫Щ╫Э)" type="textarea" />}

          <div style={{ marginTop: 32 }}>
            <div className="alert">
              <p>тЪая╕П <strong>╫Р╫Щ╫б╫Х╫и ╫Ю╫Х╫Ч╫Ь╫Ш тАФ ╫Ф╫й╫Р╫и╫к ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к ╫Ь╫Ь╫Р ╫Ф╫й╫Т╫Ч╫Ф</strong></p>
              <p>╫Р╫б╫Х╫и ╫С╫Ф╫Ч╫Ь╫Ш ╫Ь╫в╫Ц╫Х╫С ╫Р╫к ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к ╫Ь╫Ь╫Р ╫Ф╫й╫Т╫Ч╫Ф ╫С╫Ы╫Ь ╫й╫в╫Ф ╫С╫Щ╫Х╫Э ╫Х╫С╫Ь╫Щ╫Ь╫Ф. ╫Ы╫Ь ╫Щ╫ж╫Щ╫Р╫Ф ╫Ю╫Ф╫С╫Щ╫к ╫Ю╫Ч╫Щ╫Щ╫С╫к ╫к╫Щ╫Р╫Х╫Э ╫Ю╫и╫Р╫й ╫в╫Э ╫С╫а╫Щ ╫Ф╫Ю╫й╫д╫Ч╫Ф. ╫Ь╫Р ╫а╫Щ╫к╫Я ╫Ь╫в╫Ц╫Х╫С ╫Р╫Ь╫Р ╫Р╫Э ╫Щ╫й ╫Р╫У╫Э ╫Р╫Ч╫и ╫С╫С╫Щ╫к ╫й╫з╫Щ╫С╫Ь ╫в╫Ь ╫в╫ж╫Ю╫Х ╫Р╫к ╫Ф╫Р╫Ч╫и╫Щ╫Х╫к. ╫Ф╫д╫и╫к ╫б╫в╫Щ╫г ╫Ц╫Ф ╫в╫Ь╫Х╫Ь╫Ф ╫Ь╫Ф╫Х╫Х╫к ╫в╫Щ╫Ь╫Ф ╫Ь╫б╫Щ╫Х╫Э ╫Ф╫в╫б╫з╫Ф ╫Ю╫Щ╫Щ╫У╫Щ.</p>
            </div>
            <div className="ack-row">
              <input type="checkbox" checked={form.abandonmentAck} onChange={e => upd("abandonmentAck", e.target.checked)} />
              <span>╫з╫и╫Р╫к╫Щ ╫Х╫Ф╫С╫а╫к╫Щ ╫Р╫к ╫Ф╫Р╫Щ╫б╫Х╫и ╫Ф╫Ю╫Х╫Ч╫Ь╫Ш ╫Ь╫в╫Ц╫Х╫С ╫Р╫к ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к ╫Ь╫Ь╫Р ╫Ф╫й╫Т╫Ч╫Ф, ╫Х╫Р╫а╫Щ ╫Ю╫б╫Ы╫Щ╫Э/╫Ф ╫Ь╫д╫в╫Х╫Ь ╫в╫Ь ╫д╫Щ╫Х.</span>
            </div>
          </div>
        </div>

        {/* тФАтФА SEC 5 тАФ EMPLOYMENT тФАтФА */}
        <div className="sec">
          <div className="sec-title"><span className="sec-num">08</span> ╫к╫а╫Р╫Щ ╫Ф╫в╫б╫з╫Ф</div>
          <div className="grid2">
            <R field="salary" label="╫й╫Ы╫и ╫Ч╫Х╫У╫й╫Щ" />
            <R field="payDay" label="╫Щ╫Х╫Э ╫к╫й╫Ь╫Х╫Э ╫С╫Ч╫Х╫У╫й" />
            <R field="restDay" label="╫Щ╫Х╫Э ╫Ю╫а╫Х╫Ч╫Ф ╫й╫С╫Х╫в╫Щ" />
            <R field="dailyRest" label="╫й╫в╫Х╫к ╫Ю╫а╫Х╫Ч╫Ф ╫Щ╫Х╫Ю╫Щ╫Х╫к" />
            <R field="sickNotice" label="╫а╫Х╫Ф╫Ь ╫Ф╫Х╫У╫в╫Ф ╫в╫Ь ╫Ю╫Ч╫Ь╫Ф" />
          </div>
          <div style={{ marginTop: 4 }}>
            <R field="pocketMoneyType" label="╫У╫Ю╫Щ ╫Ы╫Щ╫б ╫й╫С╫Х╫в╫Щ╫Щ╫Э тАФ ╫Р╫Х╫д╫Я ╫к╫й╫Ь╫Х╫Э"
              type="radio" options={[
                { v: "advance", l: "╫Ю╫д╫и╫в╫Ф ╫в╫Ь ╫Ч╫й╫С╫Х╫Я ╫Ф╫й╫Ы╫и" },
                { v: "extra",   l: "╫а╫Х╫б╫г ╫в╫Ь ╫Ф╫С╫б╫Щ╫б" },
              ]} />
            <R field="pocketMoney" label="╫б╫Ы╫Х╫Э ╫У╫Ю╫Щ ╫Ы╫Щ╫б ╫й╫С╫Х╫в╫Щ╫Щ╫Э" />
          </div>

          {/* ╫Ч╫Х╫д╫й╫Ф ╫й╫а╫к╫Щ╫к */}
          <div style={{ marginTop: 24 }}>
            <div className="alert">
              <p><strong>╫Ч╫Х╫д╫й╫Ф ╫й╫а╫к╫Щ╫к:</strong> ╫Ю╫б╫д╫и ╫Щ╫Ю╫Щ ╫Ф╫Ч╫Х╫д╫й╫Ф ╫Ф╫Ю╫У╫Х╫Щ╫з ╫Щ╫Щ╫з╫С╫в ╫С╫Ф╫к╫Р╫Э ╫Ь╫Ч╫Х╫з, ╫Х╫С╫У╫и╫Ъ ╫Ы╫Ь╫Ь ╫Р╫Щ╫а╫Х ╫Щ╫У╫Х╫в ╫Ю╫и╫Р╫й ╫С╫к╫Ч╫Щ╫Ь╫к ╫Ф╫Ф╫в╫б╫з╫Ф. ╫в╫Ь ╫й╫а╫Щ ╫Ф╫ж╫У╫У╫Щ╫Э ╫Ь╫к╫Р╫Э ╫Ы╫Ь ╫Ч╫Х╫д╫й╫Ф ╫Ю╫и╫Р╫й ╫Ы╫У╫Щ ╫Ь╫Р╫д╫й╫и ╫Ф╫Ы╫а╫к ╫Ю╫Ч╫Ь╫Щ╫г/╫Ф ╫Ю╫к╫Р╫Щ╫Э/╫Ф.</p>
            </div>
            <R field="leaveNotice" label="╫Ф╫Х╫У╫в╫Ф ╫Ю╫и╫Р╫й ╫Ь╫Ч╫Х╫д╫й╫Ф тАФ ╫Ы╫Ю╫Ф ╫Щ╫Ю╫Щ╫Э ╫Ь╫д╫Ч╫Х╫к?" hint="╫Ч╫Х╫д╫й╫Ф ╫й╫Ь╫Р ╫к╫Х╫Р╫Ю╫Ф ╫Ю╫и╫Р╫й ╫Ь╫Р ╫к╫Р╫Х╫й╫и ╫Р╫Х╫Ш╫Х╫Ю╫Ш╫Щ╫к. ╫в╫Ь ╫Ф╫Ю╫й╫д╫Ч╫Ф ╫Ь╫Ф╫Щ╫в╫и╫Ъ ╫в╫Э ╫Ю╫Ч╫Ь╫Щ╫г/╫Ф." />
            <R field="leaveChannel" label="╫в╫и╫Х╫е ╫Ф╫Х╫У╫в╫Ф ╫в╫Ь ╫Ч╫Х╫д╫й╫Ф" type="radio" options={[{ v: "phone", l: "╫Ш╫Ь╫д╫Х╫Я" }, { v: "whatsapp", l: "╫Х╫Х╫Р╫Ш╫б╫Р╫д" }, { v: "other", l: "╫Р╫Ч╫и" }]} />
          </div>

          {/* ╫Ф╫Х╫У╫в╫Ф ╫Ю╫Х╫з╫У╫Ю╫к ╫Ь╫д╫Щ ╫Ч╫Х╫з */}
          <div style={{ marginTop: 32 }}>
            <label style={{ fontSize: 12, fontWeight: 600, display: "block", marginBottom: 12 }}>╫Ф╫Х╫У╫в╫Ф ╫Ю╫Х╫з╫У╫Ю╫к ╫Ь╫д╫а╫Щ ╫б╫Щ╫Х╫Э ╫Ф╫в╫б╫з╫Ф тАФ ╫Ь╫д╫Щ ╫Ч╫Х╫з</label>
            <div className="alert">
              <p style={{ marginBottom: 12 }}><strong>╫к╫з╫Х╫д╫Х╫к ╫Ф╫Ф╫Х╫У╫в╫Ф ╫Ф╫Ю╫Х╫з╫У╫Ю╫к ╫Ф╫з╫С╫Х╫в╫Х╫к ╫С╫Ч╫Х╫з:</strong></p>
              <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 13 }}>
                <thead>
                  <tr style={{ borderBottom: "1px solid #ddd" }}>
                    <th style={{ textAlign: "right", padding: "6px 8px", fontWeight: 600, color: "#444" }}>╫к╫з╫Х╫д╫к ╫в╫С╫Х╫У╫Ф</th>
                    <th style={{ textAlign: "right", padding: "6px 8px", fontWeight: 600, color: "#444" }}>╫Ф╫Х╫У╫в╫Ф ╫Ю╫Х╫з╫У╫Ю╫к</th>
                  </tr>
                </thead>
                <tbody>
                  {[
                    ["╫в╫У 3 ╫Ч╫Х╫У╫й╫Щ╫Э", "╫й╫С╫Х╫в ╫Щ╫Ю╫Щ╫Э"],
                    ["╫Ч╫Х╫У╫й 4 ╫в╫У ╫б╫Х╫г ╫Ч╫Х╫У╫й 6", "14 ╫Щ╫Х╫Э"],
                    ["╫Ч╫Х╫У╫й 7 ╫в╫У ╫б╫Х╫г ╫Ф╫й╫а╫Ф ╫Ф╫и╫Р╫й╫Х╫а╫Ф", "21 ╫Щ╫Х╫Э"],
                    ["╫Ю╫в╫Ь ╫й╫а╫к ╫в╫С╫Х╫У╫Ф", "╫Ч╫Х╫У╫й ╫Щ╫Ю╫Щ╫Э"],
                  ].map(([period, notice]) => (
                    <tr key={period} style={{ borderBottom: "1px solid #f0f0f0" }}>
                      <td style={{ padding: "7px 8px" }}>{period}</td>
                      <td style={{ padding: "7px 8px", fontWeight: 500 }}>{notice}</td>
                    </tr>
                  ))}
                </tbody>
              </table>
              <p style={{ marginTop: 14, fontSize: 12, color: "#555", lineHeight: 1.7 }}>
                <strong>╫Ф╫Х╫У╫в╫Ф ╫С╫Ы╫к╫С:</strong> ╫Ф╫Ч╫Х╫з ╫Ю╫Ч╫Щ╫Щ╫С ╫Р╫к ╫Ф╫в╫Х╫С╫У/╫к ╫Ь╫Ю╫б╫Х╫и ╫Ф╫Х╫У╫в╫Ф ╫Ю╫Х╫з╫У╫Ю╫к ╫С╫Ы╫к╫С.<br />
                <strong>╫У╫Т╫й ╫Ь╫б╫Щ╫в╫Х╫У:</strong> ╫Р╫Щ-╫Ю╫к╫Я ╫Ф╫Х╫У╫в╫Ф ╫Ы╫Ч╫Х╫з ╫С╫к╫Ч╫Х╫Э ╫Ф╫б╫Щ╫в╫Х╫У тАФ ╫й╫С╫Х ╫з╫Щ╫Щ╫Ю╫к ╫к╫Ь╫Х╫к ╫Щ╫й╫Щ╫и╫Ф ╫й╫Ь ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к тАФ ╫в╫Ь╫Х╫Ь ╫Ь╫Ф╫Х╫С╫Щ╫Ь ╫Ь╫Ф╫й╫Ь╫Ы╫Х╫к ╫Ю╫й╫Ю╫в╫Х╫к╫Щ╫Х╫к ╫в╫Ь ╫Ф╫в╫Х╫С╫У/╫к, ╫Ь╫и╫С╫Х╫к ╫Ф╫и╫Ч╫з╫Ф ╫Ю╫Щ╫й╫и╫Р╫Ь.
              </p>
            </div>
            <div className="ack-row">
              <input type="checkbox" checked={form.terminationAck || false} onChange={e => upd("terminationAck", e.target.checked)} />
              <span>╫з╫и╫Р╫к╫Щ ╫Х╫Ф╫С╫а╫к╫Щ ╫Р╫к ╫Ч╫Х╫С╫к ╫Ф╫Ф╫Х╫У╫в╫Ф ╫Ф╫Ю╫Х╫з╫У╫Ю╫к ╫Ь╫д╫Щ ╫Ч╫Х╫з, ╫Х╫Р╫а╫Щ ╫Ю╫к╫Ч╫Щ╫Щ╫С/╫к ╫Ь╫д╫в╫Х╫Ь ╫в╫Ь ╫д╫Щ╫Ф.</span>
            </div>
          </div>

          <div style={{ marginTop: 32 }}>
            <label style={{ fontSize: 12, fontWeight: 600, display: "block", marginBottom: 12 }}>9 ╫Щ╫Ю╫Щ ╫Ч╫Т ╫з╫С╫Х╫в╫Щ╫Э</label>
            <R field="holidaysSelected" label="╫Ф╫Р╫Э ╫а╫С╫Ч╫и╫Х 9 ╫Щ╫Ю╫Щ ╫Ф╫Ч╫Т ╫Ь╫к╫з╫Х╫д╫к ╫Ф╫Ф╫в╫б╫з╫Ф?" type="radio" options={[{ v: "yes", l: "╫Ы╫Я" }, { v: "no", l: "╫Ь╫Р" }]} />
            <div className="ack-row">
              <input type="checkbox" checked={form.holidaysAck} onChange={e => upd("holidaysAck", e.target.checked)} />
              <span>╫Щ╫У╫Х╫в ╫Ь╫Щ ╫Ы╫Щ 9 ╫Щ╫Ю╫Щ ╫Ф╫Ч╫Т ╫й╫а╫С╫Ч╫и╫Х ╫Щ╫Щ╫з╫С╫в╫Х ╫Ю╫и╫Р╫й ╫Х╫Щ╫Щ╫й╫Р╫и╫Х ╫з╫С╫Х╫в╫Щ╫Э ╫Ь╫Р╫Х╫и╫Ъ ╫Ы╫Ь ╫к╫з╫Х╫д╫к ╫Ф╫Ф╫в╫б╫з╫Ф ╫Х╫Ь╫Р ╫а╫Щ╫к╫Я ╫Щ╫Ф╫Щ╫Ф ╫Ь╫Ф╫Ч╫Ь╫Щ╫д╫Э.</span>
            </div>
          </div>
        </div>

        {/* тФАтФА SEC 6 тАФ EMERGENCY тФАтФА */}
        <div className="sec">
          <div className="sec-title"><span className="sec-num">09</span> ╫а╫Х╫Ф╫Ь╫Щ ╫Ч╫Щ╫и╫Х╫Э</div>
          <R field="fallProtocol" label="╫Ю╫Ф ╫Ь╫в╫й╫Х╫к ╫Р╫Э ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к ╫а╫Х╫д╫Ь/╫к?" type="textarea" />
          <R field="refusalProtocol" label="╫Ю╫Ф ╫Ь╫в╫й╫Х╫к ╫Р╫Э ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к ╫Ю╫б╫и╫С/╫к ╫Ь╫Р╫Ы╫Х╫Ь / ╫Ь╫з╫Ч╫к ╫к╫и╫Х╫д╫Х╫к?" type="textarea" />
          <R field="contactOrder" label="╫б╫У╫и ╫в╫У╫Щ╫д╫Х╫Щ╫Х╫к тАФ ╫Ю╫Щ ╫Ь╫Ф╫к╫з╫й╫и ╫и╫Р╫й╫Х╫Я?" hint="(╫й╫Э + ╫Ю╫б╫д╫и ╫Ш╫Ь╫д╫Х╫Я)" type="textarea" />

          {/* ╫Ь╫Ч╫ж╫Я ╫Ю╫ж╫Х╫з╫Ф */}
          <R field="distressButton" label="╫Ь╫Ч╫ж╫Я ╫Ю╫ж╫Х╫з╫Ф / ╫й╫в╫Х╫Я ╫Ч╫Ы╫Э" type="radio"
            options={[{ v: "yes", l: "╫Щ╫й тАФ ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к ╫Ю╫ж╫Х╫Щ╫У/╫к ╫С╫Ь╫Ч╫ж╫Я" }, { v: "no", l: "╫Р╫Щ╫Я" }]} />
          {form.distressButton === "yes" && (
            <R field="distressDetails" label="╫д╫и╫Ш╫Щ ╫Ь╫Ч╫ж╫Я ╫Ф╫Ю╫ж╫Х╫з╫Ф тАФ ╫Р╫Щ╫Ъ ╫Ф╫Х╫Р ╫в╫Х╫С╫У?" hint="(╫Ь╫Р╫Я ╫Ю╫Х╫в╫С╫и╫к ╫Ф╫Ф╫к╫и╫в╫Ф? ╫Ю╫Ф ╫в╫Ь ╫Ф╫в╫Х╫С╫У/╫к ╫Ь╫в╫й╫Х╫к ╫Ь╫Р╫Ч╫и ╫й╫Ф╫Х╫д╫в╫Ь?)" type="textarea" />
          )}

          {/* ╫Р╫Ю╫С╫Х╫Ь╫а╫б */}
          <R field="ambulanceAuto" label="╫Ф╫Р╫Э ╫Ф╫в╫Х╫С╫У/╫к ╫и╫й╫Р╫Щ/╫к ╫Ь╫Ф╫Ц╫в╫Щ╫з ╫Р╫Ю╫С╫Х╫Ь╫а╫б (╫Ю╫У╫┤╫Р)?"
            type="radio" options={[
              { v: "immediate", l: "╫Ы╫Я тАФ ╫Ю╫Щ╫У, ╫С╫Ы╫Ь ╫Ю╫ж╫С ╫б╫Ы╫а╫к ╫Ч╫Щ╫Щ╫Э, ╫Ь╫Ь╫Р ╫к╫Щ╫Р╫Х╫Э ╫Ю╫и╫Р╫й" },
              { v: "coord", l: "╫Ы╫Я тАФ ╫Р╫Ъ ╫Щ╫й ╫Ь╫а╫б╫Х╫к ╫Ь╫Щ╫ж╫Х╫и ╫з╫й╫и ╫в╫Э ╫С╫Я/╫С╫к ╫Ю╫й╫д╫Ч╫Ф ╫к╫Ч╫Щ╫Ь╫Ф" },
              { v: "family_first", l: "╫и╫з ╫Ь╫Р╫Ч╫и ╫Р╫Щ╫й╫Х╫и ╫С╫Я/╫С╫к ╫Ю╫й╫д╫Ч╫Ф, ╫Р╫Ь╫Р ╫Р╫Э ╫Р╫Щ╫Я ╫Р╫д╫й╫и╫Х╫к ╫Ь╫У╫С╫и" },
            ]} />
          {form.ambulanceAuto && (
            <div className="alert" style={{ marginTop: 8 }}>
              <p style={{ fontSize: 12 }}>
                {form.ambulanceAuto === "immediate" && "тЬУ ╫Ф╫в╫Х╫С╫У/╫к ╫Ю╫Х╫б╫Ю╫Ъ/╫к ╫Ь╫Ф╫Ц╫в╫Щ╫з ╫Р╫Ю╫С╫Х╫Ь╫а╫б ╫С╫Р╫Х╫д╫Я ╫в╫ж╫Ю╫Р╫Щ ╫Ю╫Щ╫Щ╫У╫Щ ╫С╫Ы╫Ь ╫Ю╫ж╫С ╫Ч╫Щ╫и╫Х╫Э."}
                {form.ambulanceAuto === "coord" && "тЬУ ╫С╫Ю╫ж╫С ╫Ч╫Щ╫и╫Х╫Э тАФ ╫Ь╫а╫б╫Х╫к ╫Ь╫Ф╫к╫з╫й╫и ╫Ь╫С╫Я/╫С╫к ╫Ф╫Ю╫й╫д╫Ч╫Ф, ╫Х╫Р╫Э ╫Ь╫Р ╫Ц╫Ю╫Щ╫а╫Щ╫Э тАФ ╫Ь╫Ф╫Ц╫в╫Щ╫з ╫Р╫Ю╫С╫Х╫Ь╫а╫б ╫С╫Р╫Х╫д╫Я ╫в╫ж╫Ю╫Р╫Щ."}
                {form.ambulanceAuto === "family_first" && "тЬУ ╫Щ╫й ╫Ь╫д╫а╫Х╫к ╫к╫Ю╫Щ╫У ╫Ь╫С╫Я/╫С╫к ╫Ф╫Ю╫й╫д╫Ч╫Ф ╫к╫Ч╫Щ╫Ь╫Ф. ╫и╫з ╫Р╫Э ╫Р╫Щ╫Я ╫Ю╫в╫а╫Ф ╫Х╫Ю╫ж╫С ╫Ф╫Ч╫Щ╫и╫Х╫Э ╫Ю╫Ч╫Щ╫Щ╫С тАФ ╫Ь╫Ф╫Ц╫в╫Щ╫з ╫Ь╫С╫У."}
              </p>
            </div>
          )}
        </div>

        {/* тФАтФА SEC 7 тАФ OPEN NOTES тФАтФА */}
        <div className="sec">
          <div className="sec-title"><span className="sec-num">10</span> ╫Ф╫в╫и╫Х╫к ╫а╫Х╫б╫д╫Х╫к</div>
          <R field="openNotes" label="╫Ы╫Ь ╫У╫С╫и ╫й╫Ь╫Р ╫Ы╫Х╫б╫Ф ╫С╫Ш╫Х╫д╫б тАФ ╫Ф╫в╫и╫Х╫к ╫Ч╫Х╫д╫й╫Щ╫Х╫к" hint="╫а╫Щ╫к╫Я ╫Ь╫и╫й╫Х╫Э ╫Ы╫Р╫Я ╫Ы╫Ь ╫Ф╫б╫Ы╫Ю╫Ф, ╫а╫Х╫Ф╫Ь, ╫Р╫Х ╫У╫Т╫й ╫й╫Ч╫й╫Х╫С ╫Ь╫й╫а╫Щ ╫Ф╫ж╫У╫У╫Щ╫Э" type="textarea" />
          <textarea placeholder="╫й╫У╫Ф ╫д╫к╫Х╫Ч ╫а╫Х╫б╫г..." value={form.openNotes} onChange={e => upd("openNotes", e.target.value)} rows={4} style={{ marginTop: 8 }} />
        </div>

        {/* тФАтФА GENERATE тФАтФА */}
        <div style={{ borderTop: "1.5px solid #111", paddingTop: 36, marginTop: 8 }}>
          <p style={{ fontSize: 13, color: "#555", marginBottom: 20 }}>
            {{ he:"╫в╫С╫и╫Щ╫к", en:"English", uz:"O╩╗zbekcha", hi:"рд╣рд┐рдиреНрджреА" }[baseLang]}
            {extraLang !== "none" && ` тЖФ ${{ en:"English", uz:"O╩╗zbekcha", hi:"рд╣рд┐рдиреНрджреА" }[extraLang]}`}
          </p>
          <button className="btn" onClick={generate}>╫Ф╫д╫з ╫У╫Х╫Ч ╫Х-PDF тЖР</button>
        </div>
      </div>
    </>
    </FormCtx.Provider>
  );
}

/* тФАтФАтФА REPORT VIEW тФАтФАтФА */

const ABANDONMENT = {
  he: "╫Р╫б╫Х╫и ╫С╫Ф╫Ч╫Ь╫Ш ╫Ь╫в╫Ц╫Х╫С ╫Р╫к ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к ╫Ь╫Ь╫Р ╫Ф╫й╫Т╫Ч╫Ф. ╫Ы╫Ь ╫Щ╫ж╫Щ╫Р╫Ф ╫Ю╫Ч╫Щ╫Щ╫С╫к ╫к╫Щ╫Р╫Х╫Э ╫в╫Э ╫Ф╫Ю╫й╫д╫Ч╫Ф ╫Х╫а╫Х╫Ы╫Ч╫Х╫к ╫Р╫У╫Э ╫Р╫Ч╫и ╫й╫з╫Щ╫С╫Ь ╫в╫Ь ╫в╫ж╫Ю╫Х ╫Р╫Ч╫и╫Щ╫Х╫к. ╫Ф╫д╫и╫Ф ╫в╫Ь╫Х╫Ь╫Ф ╫Ь╫Ф╫Х╫Х╫к ╫в╫Щ╫Ь╫Ф ╫Ь╫б╫Щ╫Х╫Э ╫Ю╫Щ╫Щ╫У╫Щ.",
  en: "It is strictly forbidden to leave the patient unattended. Any departure requires coordination with the family and the presence of another responsible person. Violation may result in immediate termination.",
  uz: "Bemorni nazoratisiz qoldirish mutlaqo taqiqlanadi. Har qanday chiqish oila bilan muvofiqlashtirilishi kerak. Qoidabuzarlik ishdan darhol bo'shatishga olib kelishi mumkin.",
  hi: "рдорд░реАрдЬ рдХреЛ рдмрд┐рдирд╛ рдирд┐рдЧрд░рд╛рдиреА рдХреЗ рдЕрдХреЗрд▓рд╛ рдЫреЛрдбрд╝рдирд╛ рд╕рдЦреНрдд рдордирд╛ рд╣реИред рдХреЛрдИ рднреА рдмрд╛рд╣рд░ рдЬрд╛рдирд╛ рдкрд░рд┐рд╡рд╛рд░ рд╕реЗ рд╕рдордиреНрд╡рдп рдХреЗ рдмрд╛рдж рд╣реА рд╕рдВрднрд╡ рд╣реИред рдЙрд▓реНрд▓рдВрдШрди рдкрд░ рддрддреНрдХрд╛рд▓ рдмрд░реНрдЦрд╛рд╕реНрддрдЧреА рд╣реЛ рд╕рдХрддреА рд╣реИред",
};
const HOLIDAYS = {
  he: "╫Щ╫У╫Х╫в ╫Ь╫Щ ╫Ы╫Щ 9 ╫Щ╫Ю╫Щ ╫Ф╫Ч╫Т ╫й╫а╫С╫Ч╫и╫Х ╫Щ╫Щ╫з╫С╫в╫Х ╫Ю╫и╫Р╫й ╫Х╫Щ╫Щ╫й╫Р╫и╫Х ╫з╫С╫Х╫в╫Щ╫Э ╫Ь╫Р╫Х╫и╫Ъ ╫Ы╫Ь ╫к╫з╫Х╫д╫к ╫Ф╫Ф╫в╫б╫з╫Ф ╫Х╫Ь╫Р ╫а╫Щ╫к╫Я ╫Щ╫Ф╫Щ╫Ф ╫Ь╫Ф╫Ч╫Ь╫Щ╫д╫Э.",
  en: "I understand that the 9 selected holidays are fixed for the entire employment period and cannot be changed.",
  uz: "9 ta tanlangan bayram kuni butun ish muddati davomida o'zgarmas bo'lib qolishini bilaman.",
  hi: "рдореБрдЭреЗ рдкрддрд╛ рд╣реИ рдХрд┐ 9 рдЪреБрдиреА рд╣реБрдИ рдЫреБрдЯреНрдЯрд┐рдпрд╛рдБ рдкреВрд░реЗ рд░реЛрдЬрдЧрд╛рд░ рдХрд╛рд▓ рдореЗрдВ рддрдп рд░рд╣реЗрдВрдЧреА рдФрд░ рдмрджрд▓реА рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддреАрдВред",
};
const TERMINATION_ROWS = {
  he: [["╫в╫У 3 ╫Ч╫Х╫У╫й╫Щ╫Э","╫й╫С╫Х╫в ╫Щ╫Ю╫Щ╫Э"],["╫Ч╫Х╫У╫й 4тАУ6","14 ╫Щ╫Х╫Э"],["╫Ч╫Х╫У╫й 7тАУ12","21 ╫Щ╫Х╫Э"],["╫Ю╫в╫Ь ╫й╫а╫Ф","╫Ч╫Х╫У╫й ╫Щ╫Ю╫Щ╫Э"]],
  en: [["Up to 3 months","1 week"],["Month 4тАУ6","14 days"],["Month 7тАУ12","21 days"],["Over 1 year","1 month"]],
  uz: [["3 oygacha","1 hafta"],["4тАУ6-oy","14 kun"],["7тАУ12-oy","21 kun"],["1 yildan ko'p","1 oy"]],
  hi: [["3 рдорд╣реАрдиреЗ рддрдХ","1 рд╕рдкреНрддрд╛рд╣"],["4тАУ6 рдорд╣реАрдирд╛","14 рджрд┐рди"],["7тАУ12 рдорд╣реАрдирд╛","21 рджрд┐рди"],["1 рд╕рд╛рд▓ рд╕реЗ рдЬреНрдпрд╛рджрд╛","1 рдорд╣реАрдирд╛"]],
};
const TERMINATION_NOTE = {
  he: "╫Ф╫Ф╫Х╫У╫в╫Ф ╫Ч╫Щ╫Щ╫С╫к ╫Ь╫Ф╫Щ╫а╫к╫Я ╫С╫Ы╫к╫С. ╫С╫к╫Ч╫Х╫Э ╫Ф╫б╫Щ╫в╫Х╫У, ╫Р╫Щ-╫Ю╫к╫Я ╫Ф╫Х╫У╫в╫Ф ╫Ы╫Ч╫Х╫з ╫в╫Ь╫Х╫Ь ╫Ь╫Ф╫Х╫С╫Щ╫Ь ╫Ь╫Ф╫и╫Ч╫з╫Ф ╫Ю╫Щ╫й╫и╫Р╫Ь.",
  en: "Notice must be given in writing. In caregiving, failure to provide legal notice may result in removal from Israel.",
  uz: "Xabar yozma shaklda berilishi shart. Parvarish sohasida qonuniy xabar bermaslik Isroildan deportatsiyaga olib kelishi mumkin.",
  hi: "рдиреЛрдЯрд┐рд╕ рд▓рд┐рдЦрд┐рдд рдореЗрдВ рджреЗрдирд╛ рдЬрд░реВрд░реА рд╣реИред рджреЗрдЦрднрд╛рд▓ рдХреНрд╖реЗрддреНрд░ рдореЗрдВ рдХрд╛рдиреВрдиреА рдиреЛрдЯрд┐рд╕ рди рджреЗрдиреЗ рдкрд░ рдЗрдЬрд░рд╛рдЗрд▓ рд╕реЗ рдирд┐рд░реНрд╡рд╛рд╕рди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред",
};
const WORKER_LABELS = { he:"╫в╫Х╫С╫У/╫к", en:"Worker / Employee", uz:"Ishchi", hi:"рдХрд░реНрдордЪрд╛рд░реА" };
const NIGHT_WORKER = {
  he: "╫Щ╫У╫Х╫в ╫Ь╫Щ ╫Ы╫Щ ╫Щ╫Щ╫к╫Ы╫а╫Х ╫з╫и╫Щ╫Р╫Х╫к ╫Ь╫Щ╫Ь╫Ф ╫Х╫в╫Ь╫Щ ╫Ь╫Ф╫Т╫Щ╫С ╫Р╫Ь╫Щ╫Ф╫Я. ╫Р╫а╫Щ ╫Ю╫С╫Щ╫Я/╫Ф ╫й╫Ц╫Ф ╫Ч╫Ь╫з ╫Ю╫Ф╫к╫д╫з╫Щ╫У.",
  en: "I understand that night calls may occur and I must respond. I understand this is part of the job.",
  uz: "Tunda chaqiruvlar bo'lishi mumkinligini va ularga javob berishim kerakligini bilaman.",
  hi: "рдореБрдЭреЗ рдкрддрд╛ рд╣реИ рд░рд╛рдд рдореЗрдВ рдмреБрд▓рд╛рд╡рд╛ рдЖ рд╕рдХрддрд╛ рд╣реИ рдФрд░ рдореБрдЭреЗ рдЬрд╡рд╛рдм рджреЗрдирд╛ рд╣реЛрдЧрд╛ред рдпрд╣ рдХрд╛рдо рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИред",
};
const NIGHT_FAMILY = {
  he: "╫Р╫а╫Х ╫Ю╫к╫Ч╫Щ╫Щ╫С╫Щ╫Э ╫Ь╫в╫й╫Х╫к ╫Ы╫Ь ╫й╫С╫Щ╫Ы╫Х╫Ь╫к╫а╫Х ╫Ь╫Р╫д╫й╫и ╫Ь╫в╫Х╫С╫У/╫к ╫й╫в╫Х╫к ╫Ю╫а╫Х╫Ч╫Ф ╫и╫ж╫Щ╫д╫Х╫к ╫Х╫Ь╫б╫У╫Щ╫и ╫Ч╫Ь╫Х╫д╫Ф ╫С╫Ь╫Щ╫Ь╫Х╫к ╫й╫С╫Ф╫Э ╫Ф╫У╫С╫и ╫Р╫д╫й╫и╫Щ.",
  en: "We commit to doing everything possible to ensure continuous rest hours for the worker, and to arrange a replacement on nights when possible.",
  uz: "Ishchiga uzluksiz dam olish soatlarini ta'minlash va imkon bo'lganda almashtirishni tashkil etish uchun barcha imkoniyatlardan foydalanamiz.",
  hi: "рд╣рдо рд╡рдЪрди рджреЗрддреЗ рд╣реИрдВ рдХрд┐ рдХрд░реНрдордЪрд╛рд░реА рдХреЛ рд▓рдЧрд╛рддрд╛рд░ рдЖрд░рд╛рдо рдХреЗ рдШрдВрдЯреЗ рджреЗрдиреЗ рдФрд░ рдЬрдм рд╕рдВрднрд╡ рд╣реЛ рд░рд╛рдд рдореЗрдВ рд╡рд┐рдХрд▓реНрдк рдХреА рд╡реНрдпрд╡рд╕реНрдерд╛ рдХрд░рдиреЗ рдХреА рдкреВрд░реА рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВрдЧреЗред",
};

/* Render one bilingual column-pair document */
function BiLangDocument({ leftPayload, rightPayload, leftLang, rightLang, leftLabel, rightLabel, form, showSig }) {
  const ls = leftPayload.sections;
  const rs = rightPayload.sections;

  const Dash = () => <span style={{ color:"#bbb", fontStyle:"italic", fontSize:12 }}>тАФ</span>;

  const BiRow = ({ lLabel, lVal, rLabel, rVal }) => (
    <div className="bi-row">
      <div className={leftLang === "he" ? "bi-he" : "bi-tr"} style={{ direction: leftLang === "he" ? "rtl" : "ltr" }}>
        <div className="bi-lbl">{lLabel}</div>
        <div className="bi-val">{lVal || <Dash />}</div>
      </div>
      <div className={rightLang === "he" ? "bi-he" : "bi-tr"} style={{ direction: rightLang === "he" ? "rtl" : "ltr", textAlign: rightLang === "he" ? "right" : "left" }}>
        <div className="bi-lbl">{rLabel}</div>
        <div className="bi-val">{rVal || <Dash />}</div>
      </div>
    </div>
  );

  const ColHeaders = ({ lTitle, rTitle }) => (
    <>
      <div className="rpt-sec-title">
        <span style={{ marginLeft:16 }}>{lTitle}</span>
        <span style={{ direction:"ltr", float:"left" }}>{rTitle}</span>
      </div>
      <div className="bi-row" style={{ borderBottom:"1px solid #ddd", marginBottom:12, paddingBottom:8 }}>
        <div className="col-hdr">{leftLabel}</div>
        <div className="col-hdr ltr">{rightLabel}</div>
      </div>
    </>
  );

  const renderSec = (lS, rS) => {
    if (!lS || !rS) return null;
    return (
      <div className="rpt-sec">
        <ColHeaders lTitle={lS.title} rTitle={rS.title} />
        {lS.fields && Object.keys(lS.fields).map(k => (
          <BiRow key={k} lLabel={lS.fields[k]?.label} lVal={lS.fields[k]?.value}
            rLabel={rS.fields?.[k]?.label} rVal={rS.fields?.[k]?.value} />
        ))}
        {lS.meals && lS.meals.map((m, i) => (
          <BiRow key={i} lLabel={m.name} lVal={m.time}
            rLabel={rs.s3?.meals?.[i]?.name || rS.meals?.[i]?.name} rVal={rs.s3?.meals?.[i]?.time || rS.meals?.[i]?.time} />
        ))}
        {lS.tasks && lS.tasks.map((t, i) => (
          <BiRow key={i}
            lLabel={t.name}
            lVal={`${t.included==="yes"?"╫Ы╫Я":t.included==="no"?"╫Ь╫Р":t.included}${t.notes?" тАФ "+t.notes:""}`}
            rLabel={rS.tasks?.[i]?.name}
            rVal={`${rS.tasks?.[i]?.included||""}${rS.tasks?.[i]?.notes?" тАФ "+rS.tasks[i].notes:""}`}
          />
        ))}
        {lS.openNotes && <BiRow lLabel={lS.openNotes.label} lVal={lS.openNotes.value}
          rLabel={rS.openNotes?.label} rVal={rS.openNotes?.value} />}
      </div>
    );
  };

  const termRows = (lang) => (TERMINATION_ROWS[lang] || TERMINATION_ROWS.en).map(([p,n],i) => (
    <tr key={i} style={{ borderBottom:"1px solid #f0f0f0" }}>
      <td style={{ padding:"5px 0", color:"#555" }}>{p}</td>
      <td style={{ padding:"5px 0", fontWeight:600 }}>{n}</td>
    </tr>
  ));

  return (
    <>
      {renderSec(ls.s0, rs.s0)}
      {renderSec(ls.s1, rs.s1)}
      {renderSec(ls.s2, rs.s2)}
      {renderSec(ls.s3, rs.s3)}
      {renderSec(ls.s3b, rs.s3b)}
      {renderSec(ls.s4, rs.s4)}
      {renderSec(ls.s5, rs.s5)}
      {renderSec(ls.s6, rs.s6)}
      {renderSec(ls.s7, rs.s7)}

      {/* Abandonment clause */}
      <div className="rpt-sec">
        <ColHeaders lTitle="╫б╫в╫Щ╫г ╫Ю╫Ч╫Щ╫Щ╫С тАФ ╫Ф╫й╫Р╫и╫к ╫Ф╫Ю╫Ш╫Х╫д╫Ь/╫к ╫Ь╫Ь╫Р ╫Ф╫й╫Т╫Ч╫Ф" rTitle="тЪа" />
        <BiRow lLabel="" lVal={ABANDONMENT[leftLang]} rLabel="" rVal={ABANDONMENT[rightLang]} />
      </div>

      {/* Night watch */}
      {form.nightWatch !== "no" && (
        <div className="rpt-sec">
          <ColHeaders lTitle="╫Ф╫б╫Ы╫Ю╫Ф ╫Ф╫У╫У╫Щ╫к тАФ ╫Ф╫й╫Т╫Ч╫к ╫Ь╫Щ╫Ь╫Ф" rTitle="Night Watch Agreement" />
          <BiRow lLabel="╫Ф╫в╫Х╫С╫У/╫к" lVal={NIGHT_WORKER[leftLang]}
            rLabel={WORKER_LABELS[rightLang]} rVal={NIGHT_WORKER[rightLang]} />
          <BiRow lLabel="╫Ф╫Ю╫й╫д╫Ч╫Ф" lVal={NIGHT_FAMILY[leftLang]}
            rLabel="Family" rVal={NIGHT_FAMILY[rightLang]} />
        </div>
      )}

      {/* Holidays */}
      <div className="rpt-sec">
        <ColHeaders lTitle="9 ╫Щ╫Ю╫Щ ╫Ч╫Т ╫з╫С╫Х╫в╫Щ╫Э" rTitle="9 Fixed Holidays" />
        <BiRow lLabel="" lVal={(form.holidaysAck?"тЬУ ":"")+HOLIDAYS[leftLang]}
          rLabel="" rVal={(form.holidaysAck?"тЬУ ":"")+HOLIDAYS[rightLang]} />
      </div>

      {/* Termination */}
      <div className="rpt-sec">
        <ColHeaders lTitle="╫Ф╫Х╫У╫в╫Ф ╫Ю╫Х╫з╫У╫Ю╫к ╫Ь╫д╫Щ ╫Ч╫Х╫з" rTitle="Notice Period by Law" />
        <div className="bi-row">
          <div style={{ direction: leftLang==="he"?"rtl":"ltr" }}>
            <table style={{ width:"100%", borderCollapse:"collapse", fontSize:12 }}><tbody>{termRows(leftLang)}</tbody></table>
            <p style={{ fontSize:11, color:"#777", marginTop:8, lineHeight:1.6 }}>{TERMINATION_NOTE[leftLang]}</p>
            <div style={{ fontSize:12, marginTop:6 }}>
              {leftLang==="he" ? `╫Р╫Щ╫й╫Х╫и ╫Ф╫в╫Х╫С╫У/╫к: ${form.terminationAck?"тЬУ ╫Ю╫Р╫й╫и/╫к":"╫Ш╫и╫Э ╫Р╫Х╫й╫и"}` : ""}
            </div>
          </div>
          <div style={{ direction: rightLang==="he"?"rtl":"ltr", textAlign: rightLang==="he"?"right":"left" }}>
            <table style={{ width:"100%", borderCollapse:"collapse", fontSize:12 }}><tbody>{termRows(rightLang)}</tbody></table>
            <p style={{ fontSize:11, color:"#777", marginTop:8, lineHeight:1.6 }}>{TERMINATION_NOTE[rightLang]}</p>
          </div>
        </div>
      </div>

      {/* Signature */}
      {showSig && (
        <div className="rpt-sec" style={{ marginTop:48 }}>
          <div className="rpt-sec-title">╫Ч╫к╫Щ╫Ю╫Х╫к / Signatures</div>
          <div className="sig-wrap">
            <div className="sig-box">
              <div className="sig-box-title">╫Ф╫Ю╫й╫д╫Ч╫Ф</div>
              <div style={{ fontSize:12, color:"#555", marginBottom:4 }}>╫й╫Э: {form.familySignName||"___________________"}</div>
              <div className="sig-line" /><div className="sig-label">╫Ч╫к╫Щ╫Ю╫Ф</div>
              <div style={{ marginTop:16, fontSize:12, color:"#555" }}>╫к╫Р╫и╫Щ╫Ъ: {form.signDate||"___________________"}</div>
            </div>
            <div className="sig-box" style={{ direction:"ltr", textAlign:"left" }}>
              <div className="sig-box-title">{WORKER_LABELS[rightLang]}</div>
              <div style={{ fontSize:12, color:"#555", marginBottom:4 }}>Name: {form.workerSignName||"___________________"}</div>
              <div className="sig-line" /><div className="sig-label">Signature</div>
              <div style={{ marginTop:16, fontSize:12, color:"#555" }}>Date: {form.signDate||"___________________"}</div>
            </div>
          </div>
        </div>
      )}
    </>
  );
}

const INTRO_TEXT = {
  he: { title: "╫Ь╫д╫а╫Щ╫Ы╫Э ╫б╫Щ╫Ы╫Х╫Э ╫к╫Щ╫Р╫Х╫Э ╫Ф╫ж╫Щ╫д╫Щ╫Х╫к тАУ ╫Ф╫С╫б╫Щ╫б ╫Ь╫й╫Х╫к╫д╫Х╫к ╫Ю╫Х╫ж╫Ь╫Ч╫к.", body: "╫Ю╫б╫Ю╫Ъ ╫Ц╫Ф ╫Р╫Щ╫а╫Х ╫и╫з ╫б╫Щ╫Ы╫Х╫Э ╫Ш╫Ы╫а╫Щ, ╫Р╫Ь╫Р ╫Ф╫к╫й╫к╫Щ╫к ╫Ь╫Ф╫ж╫Ь╫Ч╫к ╫Ф╫Ш╫Щ╫д╫Х╫Ь ╫Ф╫б╫Щ╫в╫Х╫У╫Щ ╫С╫С╫Щ╫к╫Ы╫Э. ╫Ю╫Ш╫и╫к╫Х ╫Ь╫Т╫й╫и ╫в╫Ь ╫д╫в╫и╫Щ ╫Ф╫и╫Т╫Ь╫Щ╫Э ╫Х╫Ф╫й╫з╫д╫Х╫к ╫в╫Х╫Ь╫Э, ╫Ь╫Ю╫а╫Х╫в ╫Р╫Щ-╫Ф╫С╫а╫Х╫к ╫Х╫Ь╫Щ╫Щ╫ж╫и ╫б╫С╫Щ╫С╫к ╫в╫С╫Х╫У╫Ф ╫а╫в╫Щ╫Ю╫Ф. ╫Ц╫Ф╫Х ╫Ф╫ж╫в╫У ╫Ф╫и╫Р╫й╫Х╫Я ╫Ь╫С╫а╫Щ╫Щ╫к ╫Р╫Ю╫Х╫Я ╫Ф╫У╫У╫Щ ╫Х╫й╫Т╫и╫Ф ╫Щ╫ж╫Щ╫С╫Ф ╫Х╫Ю╫Х╫к╫Р╫Ю╫к ╫Р╫Щ╫й╫Щ╫к." },
  en: { title: "Expectations Agreement тАФ The Foundation of a Successful Partnership.", body: "This document is not merely a technical summary, but the foundation for successful caregiving in your home. Its purpose is to bridge cultural gaps, prevent misunderstandings, and create a pleasant work environment." },
  uz: { title: "Kutishlarni muvofiqlashtirish тАФ Muvaffaqiyatli hamkorlik asosi.", body: "Ushbu hujjat texnik xulosa emas, balki sizning uyingizda muvaffaqiyatli parvarish asosi hisoblanadi." },
  hi: { title: "рдЕрдкреЗрдХреНрд╖рд╛рдУрдВ рдХрд╛ рд╕рдордЭреМрддрд╛ тАФ рд╕рдлрд▓ рд╕рд╛рдЭреЗрджрд╛рд░реА рдХреА рдиреАрдВрд╡ред", body: "рдпрд╣ рджрд╕реНрддрд╛рд╡реЗрдЬрд╝ рдХреЗрд╡рд▓ рддрдХрдиреАрдХреА рд╕рд╛рд░рд╛рдВрд╢ рдирд╣реАрдВ рд╣реИ, рдмрд▓реНрдХрд┐ рдЖрдкрдХреЗ рдШрд░ рдореЗрдВ рд╕рдлрд▓ рджреЗрдЦрднрд╛рд▓ рдХреА рдиреАрдВрд╡ рд╣реИред" },
};

function ReportIntro({ leftLang, rightLang }) {
  const L = INTRO_TEXT[leftLang] || INTRO_TEXT.he;
  const R = INTRO_TEXT[rightLang] || INTRO_TEXT.en;
  return (
    <div style={{ border:"1.5px solid #ccc", borderRadius:10, padding:"22px 26px", marginBottom:36, background:"#fafafa", lineHeight:1.8, pageBreakInside:"avoid" }}>
      <div style={{ display:"grid", gridTemplateColumns:"1fr 1fr", gap:20 }}>
        <div style={{ direction: leftLang==="he"?"rtl":"ltr" }}>
          <p style={{ fontSize:13, fontWeight:600, marginBottom:8, color:"#111" }}>{L.title}</p>
          <p style={{ fontSize:12, color:"#444" }}>{L.body}</p>
        </div>
        <div style={{ direction: rightLang==="he"?"rtl":"ltr", textAlign: rightLang==="he"?"right":"left" }}>
          <p style={{ fontSize:13, fontWeight:600, marginBottom:8, color:"#111" }}>{R.title}</p>
          <p style={{ fontSize:12, color:"#444" }}>{R.body}</p>
        </div>
      </div>
    </div>
  );
}

function Report({ report, form, onBack }) {
  const { mode, lang, singlePayload, leftLang, rightLang, leftPayload, rightPayload } = report;
  const LNAME = { he:"╫в╫С╫и╫Щ╫к", en:"English", uz:"O╩╗zbekcha", hi:"рд╣рд┐рдиреНрджреА" };
  const DATE = form.startDate || new Date().toLocaleDateString("he-IL");
  const META = `╫Ю╫Ш╫Х╫д╫Ь/╫к: ${form.patientName||"тАФ"} | ╫в╫Х╫С╫У/╫к: ${form.workerName||"тАФ"} | ${DATE}`;
  const isHe = (l) => l === "he";

  const SingleSection = ({ sec, l }) => {
    if (!sec) return null;
    return (
      <div className="rpt-sec" style={{ direction: isHe(l)?"rtl":"ltr" }}>
        <div className="rpt-sec-title">{sec.title}</div>
        {sec.fields && Object.entries(sec.fields).map(([f,fld]) => (
          <div key={f} style={{ marginBottom:12, paddingBottom:12, borderBottom:"1px solid #f5f5f5" }}>
            <div style={{ fontSize:10, color:"#999" }}>{fld.label}</div>
            <div style={{ fontSize:13 }}>{fld.value||"тАФ"}</div>
          </div>
        ))}
        {sec.tasks && sec.tasks.map((t,i) => (
          <div key={i} style={{ marginBottom:10, paddingBottom:10, borderBottom:"1px solid #f5f5f5" }}>
            <div style={{ fontSize:10, color:"#999" }}>{t.name}</div>
            <div style={{ fontSize:13 }}>{t.included}{t.notes?" тАФ "+t.notes:""}</div>
          </div>
        ))}
        {sec.meals && sec.meals.map((m,i) => (
          <div key={i} style={{ marginBottom:10, paddingBottom:10, borderBottom:"1px solid #f5f5f5" }}>
            <div style={{ fontSize:10, color:"#999" }}>{m.name}</div>
            <div style={{ fontSize:13 }}>{m.time||"тАФ"}</div>
          </div>
        ))}
        {sec.openNotes && (
          <div style={{ marginBottom:12, paddingBottom:12, borderBottom:"1px solid #f5f5f5" }}>
            <div style={{ fontSize:10, color:"#999" }}>{sec.openNotes.label}</div>
            <div style={{ fontSize:13 }}>{sec.openNotes.value||"тАФ"}</div>
          </div>
        )}
      </div>
    );
  };

  return (
    <>
      <style>{STYLE}</style>
      <div className="rpt">
        <div className="no-print" style={{ display:"flex", gap:12, marginBottom:40, alignItems:"center", flexWrap:"wrap" }}>
          <button className="btn" onClick={() => window.print()}>ЁЯЦи ╫Ф╫У╫д╫б / ╫й╫Ю╫Х╫и PDF</button>
          <button className="btn-out" onClick={onBack}>тЖР ╫Ч╫Ц╫и╫Ф ╫Ь╫в╫и╫Щ╫Ы╫Ф</button>
          <span style={{ fontSize:12, color:"#888", lineHeight:1.5 }}>
            ╫д╫к╫Ч ╫Р╫к ╫Ф╫з╫Х╫С╫е ╫й╫Ф╫Х╫и╫У ╫С╫У╫д╫У╫д╫Я тЖР Ctrl+P / тМШ+P ╫Ь╫Ф╫У╫д╫б╫Ф / ╫й╫Ю╫Щ╫и╫Ф ╫Ы-PDF
          </span>
        </div>

        <div className="rpt-hdr">
          <div className="rpt-hdr-title">╫к╫Щ╫Р╫Х╫Э ╫ж╫Щ╫д╫Щ╫Х╫к тАФ ╫а╫б╫д╫Ч ╫Ь╫Ч╫Х╫Ц╫Ф</div>
          {mode === "pair" && (
            <div style={{ display:"flex", justifyContent:"space-between", fontSize:11, color:"#888", marginTop:6 }}>
              <span style={{ direction:"ltr" }}>{LNAME[leftLang]}</span>
              <span>тЖФ</span>
              <span>{LNAME[rightLang]}</span>
            </div>
          )}
          <div className="rpt-meta"><span>{META}</span></div>
        </div>

        {mode === "pair" ? (
          <>
            <ReportIntro leftLang={leftLang} rightLang={rightLang} />
            <BiLangDocument
              leftPayload={leftPayload} rightPayload={rightPayload}
              leftLang={leftLang} rightLang={rightLang}
              leftLabel={LNAME[leftLang]} rightLabel={LNAME[rightLang]}
              form={form} showSig={true}
            />
          </>
        ) : (
          <>
            <div style={{
              border:"1.5px solid #ccc", borderRadius:10, padding:"22px 26px",
              marginBottom:36, background:"#fafafa", lineHeight:1.8,
              direction: isHe(lang)?"rtl":"ltr"
            }}>
              <p style={{ fontSize:13, fontWeight:600, marginBottom:8 }}>{INTRO_TEXT[lang]?.title}</p>
              <p style={{ fontSize:12, color:"#444" }}>{INTRO_TEXT[lang]?.body}</p>
            </div>
            {Object.entries(singlePayload.sections).map(([k,sec]) => (
              <SingleSection key={k} sec={sec} l={lang} />
            ))}
            <div className="rpt-sec" style={{ marginTop:48, direction: isHe(lang)?"rtl":"ltr" }}>
              <div className="rpt-sec-title">{isHe(lang)?"╫Ч╫к╫Щ╫Ю╫Х╫к":"Signatures"}</div>
              <div className="sig-wrap">
                <div className="sig-box">
                  <div className="sig-box-title">{isHe(lang)?"╫Ф╫Ю╫й╫д╫Ч╫Ф":"Family"}</div>
                  <div style={{ fontSize:12, marginBottom:4 }}>{isHe(lang)?"╫й╫Э:":"Name:"} {form.familySignName||"___________________"}</div>
                  <div className="sig-line" /><div className="sig-label">{isHe(lang)?"╫Ч╫к╫Щ╫Ю╫Ф":"Signature"}</div>
                  <div style={{ marginTop:16, fontSize:12 }}>{isHe(lang)?"╫к╫Р╫и╫Щ╫Ъ:":"Date:"} {form.signDate||"___________________"}</div>
                </div>
                <div className="sig-box">
                  <div className="sig-box-title">{WORKER_LABELS[lang]||"╫в╫Х╫С╫У/╫к"}</div>
                  <div style={{ fontSize:12, marginBottom:4 }}>{isHe(lang)?"╫й╫Э:":"Name:"} {form.workerSignName||"___________________"}</div>
                  <div className="sig-line" /><div className="sig-label">{isHe(lang)?"╫Ч╫к╫Щ╫Ю╫Ф":"Signature"}</div>
                  <div style={{ marginTop:16, fontSize:12 }}>{isHe(lang)?"╫к╫Р╫и╫Щ╫Ъ:":"Date:"} {form.signDate||"___________________"}</div>
                </div>
              </div>
            </div>
          </>
        )}

        <div style={{ textAlign:"center", fontSize:10, color:"#bbb", marginTop:40, paddingTop:16, borderTop:"1px solid #eee" }}>
          ╫к╫Щ╫Р╫Х╫Э ╫ж╫Щ╫д╫Щ╫Х╫к тАФ ╫а╫б╫д╫Ч ╫Ь╫Ч╫Х╫Ц╫Ф &nbsp;|&nbsp; Expectations Agreement тАФ Contract Addendum
        </div>
      </div>
    </>
  );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(React.createElement(CaregiverAgreement));
  </script>
</body>
</html>
